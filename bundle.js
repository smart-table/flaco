(function () {
'use strict';

function h (nodeType, props, ...children) {
  const flatChildren = children.reduce((acc, child) => {
    const childrenArray = Array.isArray(child) ? child : [child];
    return acc.concat(childrenArray);
  }, [])
    .map(child => {
      // normalize text node to have same structure than regular dom node (looks like easier for runtime to optimize)
      const s = typeof child;
      return s !== 'function' && s !== 'object' ? {
          nodeType: 'Text',
          children: [],
          props: {
            value: child
          },
          events: {},
          length: 0
        } : child;
    });

  if (typeof nodeType === 'function') {
    return nodeType(Object.assign({children: flatChildren}, props));
  }

  const attributes = Object.assign({}, props);
  const events = {};
  const eventKeys = Object.keys(props || {}).filter(k => k.substr(0, 2) === 'on');

  for (let ev of eventKeys) {
    events[ev.substr(2).toLowerCase()] = props[ev];
    delete attributes[ev];
  }

  return {
    nodeType,
    props: attributes,
    children: flatChildren,
    length: flatChildren.length,
    events
  };
}

function compose (first, ...fns) {
  return (...args) => fns.reduce((previous, current) => current(previous), first(...args));
}

const upsertChild = (parentNode, newChild, oldChild) => {
  return oldChild ? parentNode.replaceChild(newChild, oldChild) : parentNode.appendChild(newChild);
};

const removeAttributes = (...attributes) => (domNode) => {
  for (let attr of attributes) {
    domNode.removeAttribute(attr);
  }
  return domNode;
};

const removeEventListeners = (...listeners) => (domNode) => {
  for (let [event, listener] of listeners) {
    domNode.removeEventListener(event, listener);
  }
  return domNode;
};

const addEventListeners = (...listeners) => (domNode) => {
  for (let [event, listener] of listeners) {
    domNode.addEventListener(event, listener);
  }
  return domNode;
};

const setAttributes = (...pairs) => (domNode) => {
  const attributes = pairs.filter(p => typeof p[1] !== 'function' && typeof p[1] !== 'object');
  for (let [attr, value] of attributes) {
    domNode.setAttribute(attr, value);
  }
  return domNode;
};

const setTextNode = val => node => node.textContent = val;

const createDomNode = vnode => {
  return vnode.nodeType === 'Text' ?
    document.createTextNode(String(vnode.props.value)) :
    document.createElement(vnode.nodeType);
};

const isShallowEqual = (a, b) => {
  const aKeys = Object.keys(a);
  const bKeys = Object.keys(b);
  return aKeys.length === bKeys.length && aKeys.every((k) => a[k] === b[k]);
};

//the domNode parent of the eventual childNode represented by a virtual node.
// oldNode being the old version of the virtual node, newNode the current version
function toDom (parentDom, oldNode, newNode, domFactory) {
  let domNode;
  let garbage = null;
  if (newNode) {
    if (!oldNode || oldNode.nodeType !== newNode.nodeType) {
      domNode = domFactory(newNode);
      const diff = upsertChild(parentDom, domNode, oldNode && oldNode.dom) || null;
      garbage = oldNode && diff === oldNode.dom ? oldNode : null;
      newNode.dom = domNode;
    }
    newNode.dom = newNode.dom || oldNode.dom;
  } else if (oldNode) {
    parentDom.removeChild(oldNode.dom);
    garbage = oldNode;
  }
  return newNode ? {domNode: newNode.dom, garbage} : {garbage};
}

//return a function operating on DOM nodes based on vnode props diffing
function updateAttributes (newVNode, oldVNode) {
  const newVNodeProps = newVNode.props || {};
  const oldVNodeProps = oldVNode.props || {};
  const newNodeEvents = newVNode.events || {};
  const oldNodeEvents = oldVNode.events || {};

  if (isShallowEqual(newVNodeProps, oldVNodeProps)) {
    return () => {/* do nothing */
    };
  }

  if (newVNode.nodeType === 'Text') {
    return setTextNode(newVNode.props.value);
  }

  const newNodeKeys = Object.keys(newVNodeProps);
  const oldNodeKeys = Object.keys(oldVNodeProps);
  const toRemove = oldNodeKeys.filter(k => !newNodeKeys.includes(k));

  const pairify = holder => key => [key, holder[key]];

  return compose(
    removeEventListeners(...Object.keys(oldNodeEvents).map(pairify(oldNodeEvents))),
    removeAttributes(...toRemove),
    setAttributes(...newNodeKeys.map(pairify(newVNodeProps))),
    addEventListeners(...Object.keys(newNodeEvents).map(pairify(newNodeEvents)))
  );
}

// update a dom node and its descendant based on its virtual node representation
// oldNode being the old version of the virtual node, newNode the current version
function updateTree (parentDom, oldNode, newNode, domFactory = createDomNode) {

  let garbageCollector = [];
  const tempOldNode = oldNode ? oldNode : {length: 0, children: []};

  //1. get the actual dom element related to virtual dom diff && collect node to remove/clean
  const {domNode, garbage} = toDom(parentDom, oldNode, newNode, domFactory);

  if (garbage !== null) {
    garbageCollector.push(garbage);
  }

  //2. update attributes
  if (domNode) {
    const updateFunc = updateAttributes(newNode, tempOldNode);
    updateFunc(domNode);

    //3 recursively do the same for children
    for (let i = 0; i < Math.max(tempOldNode.length, newNode.length); i++) {
      garbageCollector = garbageCollector.concat(updateTree(domNode, tempOldNode.children[i], newNode.children[i], domFactory));
    }
  }

  return garbageCollector;
}

// if you have specific memory requirement:
// this instance will clean and reuse dom nodes
// instead of throwing them and recreating new ones
var recyclerFactory = function () {

  const pool = {};

  const recycler = {
    create(vnode){
      const p = pool[vnode.nodeType] || [];
      const t = p.shift();
      return t || createDomNode(vnode);
    },
    collect(garbage){
      for (let vnode of garbage) {
        const dom = vnode.dom;
        //todo clean dom node event listeners etc
        vnode.dom = null;
        pool[vnode.nodeType] = pool[vnode.nodeType] || [];
        pool[vnode.nodeType].push(dom);
        recycler.collect(vnode.children);
      }
    }
  };
  return recycler;
};

function itemify (string) {
  const items = [];
  const numbers = Math.ceil(Math.random() * 1000);
  console.log(numbers);
  for (let i = 0; i < numbers; i++) {
    items.push({id: i, value: string + i + ' ' + Date.now()});
  }

  return items;
}

const Item = ({item, children}) => (h( 'li', { id: item.id }, children));

const div = ({title, items = []}) => (
  h( 'div', null,
    h( 'ul', null,
      items.map(item => (h( Item, { item: item }, item.value)))
    )
  ));

let mainElement = document.getElementById('main');
console.time('set');
let oldVnode = div({items: itemify('foo')});
const main = updateTree(mainElement, null, oldVnode);
console.timeEnd('set');

const recycler = recyclerFactory();

const [b] = document.getElementsByTagName('button');
b.addEventListener('click', () => {
  console.time('update');
  const newVnode = div({items: itemify('updated at')});
  const garbage = updateTree(mainElement, oldVnode, newVnode, recycler.create);
  oldVnode = newVnode;
  console.timeEnd('update');
  recycler.collect(garbage || []);
});

}());
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYnVuZGxlLmpzIiwic291cmNlcyI6WyJsaWIvaC5qcyIsIm5vZGVfbW9kdWxlcy9zbWFydC10YWJsZS1vcGVyYXRvcnMvaW5kZXguanMiLCJsaWIvdXRpbC5qcyIsImxpYi9yZW5kZXIuanMiLCJsaWIvcmVjeWNsZXIuanMiLCJpbmRleC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBoIChub2RlVHlwZSwgcHJvcHMsIC4uLmNoaWxkcmVuKSB7XG4gIGNvbnN0IGZsYXRDaGlsZHJlbiA9IGNoaWxkcmVuLnJlZHVjZSgoYWNjLCBjaGlsZCkgPT4ge1xuICAgIGNvbnN0IGNoaWxkcmVuQXJyYXkgPSBBcnJheS5pc0FycmF5KGNoaWxkKSA/IGNoaWxkIDogW2NoaWxkXTtcbiAgICByZXR1cm4gYWNjLmNvbmNhdChjaGlsZHJlbkFycmF5KTtcbiAgfSwgW10pXG4gICAgLm1hcChjaGlsZCA9PiB7XG4gICAgICAvLyBub3JtYWxpemUgdGV4dCBub2RlIHRvIGhhdmUgc2FtZSBzdHJ1Y3R1cmUgdGhhbiByZWd1bGFyIGRvbSBub2RlIChsb29rcyBsaWtlIGVhc2llciBmb3IgcnVudGltZSB0byBvcHRpbWl6ZSlcbiAgICAgIGNvbnN0IHMgPSB0eXBlb2YgY2hpbGQ7XG4gICAgICByZXR1cm4gcyAhPT0gJ2Z1bmN0aW9uJyAmJiBzICE9PSAnb2JqZWN0JyA/IHtcbiAgICAgICAgICBub2RlVHlwZTogJ1RleHQnLFxuICAgICAgICAgIGNoaWxkcmVuOiBbXSxcbiAgICAgICAgICBwcm9wczoge1xuICAgICAgICAgICAgdmFsdWU6IGNoaWxkXG4gICAgICAgICAgfSxcbiAgICAgICAgICBldmVudHM6IHt9LFxuICAgICAgICAgIGxlbmd0aDogMFxuICAgICAgICB9IDogY2hpbGQ7XG4gICAgfSk7XG5cbiAgaWYgKHR5cGVvZiBub2RlVHlwZSA9PT0gJ2Z1bmN0aW9uJykge1xuICAgIHJldHVybiBub2RlVHlwZShPYmplY3QuYXNzaWduKHtjaGlsZHJlbjogZmxhdENoaWxkcmVufSwgcHJvcHMpKTtcbiAgfVxuXG4gIGNvbnN0IGF0dHJpYnV0ZXMgPSBPYmplY3QuYXNzaWduKHt9LCBwcm9wcyk7XG4gIGNvbnN0IGV2ZW50cyA9IHt9O1xuICBjb25zdCBldmVudEtleXMgPSBPYmplY3Qua2V5cyhwcm9wcyB8fCB7fSkuZmlsdGVyKGsgPT4gay5zdWJzdHIoMCwgMikgPT09ICdvbicpO1xuXG4gIGZvciAobGV0IGV2IG9mIGV2ZW50S2V5cykge1xuICAgIGV2ZW50c1tldi5zdWJzdHIoMikudG9Mb3dlckNhc2UoKV0gPSBwcm9wc1tldl07XG4gICAgZGVsZXRlIGF0dHJpYnV0ZXNbZXZdO1xuICB9XG5cbiAgcmV0dXJuIHtcbiAgICBub2RlVHlwZSxcbiAgICBwcm9wczogYXR0cmlidXRlcyxcbiAgICBjaGlsZHJlbjogZmxhdENoaWxkcmVuLFxuICAgIGxlbmd0aDogZmxhdENoaWxkcmVuLmxlbmd0aCxcbiAgICBldmVudHNcbiAgfTtcbn07IiwiZXhwb3J0IGZ1bmN0aW9uIHN3YXAgKGYpIHtcbiAgcmV0dXJuIChhLCBiKSA9PiBmKGIsIGEpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gY29tcG9zZSAoZmlyc3QsIC4uLmZucykge1xuICByZXR1cm4gKC4uLmFyZ3MpID0+IGZucy5yZWR1Y2UoKHByZXZpb3VzLCBjdXJyZW50KSA9PiBjdXJyZW50KHByZXZpb3VzKSwgZmlyc3QoLi4uYXJncykpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gY3VycnkgKGZuLCBhcml0eUxlZnQpIHtcbiAgY29uc3QgYXJpdHkgPSBhcml0eUxlZnQgfHwgZm4ubGVuZ3RoO1xuICByZXR1cm4gKC4uLmFyZ3MpID0+IHtcbiAgICBjb25zdCBhcmdMZW5ndGggPSBhcmdzLmxlbmd0aCB8fCAxO1xuICAgIGlmIChhcml0eSA9PT0gYXJnTGVuZ3RoKSB7XG4gICAgICByZXR1cm4gZm4oLi4uYXJncyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnN0IGZ1bmMgPSAoLi4ubW9yZUFyZ3MpID0+IGZuKC4uLmFyZ3MsIC4uLm1vcmVBcmdzKTtcbiAgICAgIHJldHVybiBjdXJyeShmdW5jLCBhcml0eSAtIGFyZ3MubGVuZ3RoKTtcbiAgICB9XG4gIH07XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBhcHBseSAoZm4pIHtcbiAgcmV0dXJuICguLi5hcmdzKSA9PiBmbiguLi5hcmdzKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHRhcCAoZm4pIHtcbiAgcmV0dXJuIGFyZyA9PiB7XG4gICAgZm4oYXJnKTtcbiAgICByZXR1cm4gYXJnO1xuICB9XG59IiwiZXhwb3J0IGNvbnN0IHVwc2VydENoaWxkID0gKHBhcmVudE5vZGUsIG5ld0NoaWxkLCBvbGRDaGlsZCkgPT4ge1xuICByZXR1cm4gb2xkQ2hpbGQgPyBwYXJlbnROb2RlLnJlcGxhY2VDaGlsZChuZXdDaGlsZCwgb2xkQ2hpbGQpIDogcGFyZW50Tm9kZS5hcHBlbmRDaGlsZChuZXdDaGlsZCk7XG59O1xuXG5leHBvcnQgY29uc3QgcmVtb3ZlQXR0cmlidXRlcyA9ICguLi5hdHRyaWJ1dGVzKSA9PiAoZG9tTm9kZSkgPT4ge1xuICBmb3IgKGxldCBhdHRyIG9mIGF0dHJpYnV0ZXMpIHtcbiAgICBkb21Ob2RlLnJlbW92ZUF0dHJpYnV0ZShhdHRyKTtcbiAgfVxuICByZXR1cm4gZG9tTm9kZTtcbn07XG5cbmV4cG9ydCBjb25zdCByZW1vdmVFdmVudExpc3RlbmVycyA9ICguLi5saXN0ZW5lcnMpID0+IChkb21Ob2RlKSA9PiB7XG4gIGZvciAobGV0IFtldmVudCwgbGlzdGVuZXJdIG9mIGxpc3RlbmVycykge1xuICAgIGRvbU5vZGUucmVtb3ZlRXZlbnRMaXN0ZW5lcihldmVudCwgbGlzdGVuZXIpO1xuICB9XG4gIHJldHVybiBkb21Ob2RlO1xufTtcblxuZXhwb3J0IGNvbnN0IGFkZEV2ZW50TGlzdGVuZXJzID0gKC4uLmxpc3RlbmVycykgPT4gKGRvbU5vZGUpID0+IHtcbiAgZm9yIChsZXQgW2V2ZW50LCBsaXN0ZW5lcl0gb2YgbGlzdGVuZXJzKSB7XG4gICAgZG9tTm9kZS5hZGRFdmVudExpc3RlbmVyKGV2ZW50LCBsaXN0ZW5lcik7XG4gIH1cbiAgcmV0dXJuIGRvbU5vZGU7XG59O1xuXG5leHBvcnQgY29uc3Qgc2V0QXR0cmlidXRlcyA9ICguLi5wYWlycykgPT4gKGRvbU5vZGUpID0+IHtcbiAgY29uc3QgYXR0cmlidXRlcyA9IHBhaXJzLmZpbHRlcihwID0+IHR5cGVvZiBwWzFdICE9PSAnZnVuY3Rpb24nICYmIHR5cGVvZiBwWzFdICE9PSAnb2JqZWN0Jyk7XG4gIGZvciAobGV0IFthdHRyLCB2YWx1ZV0gb2YgYXR0cmlidXRlcykge1xuICAgIGRvbU5vZGUuc2V0QXR0cmlidXRlKGF0dHIsIHZhbHVlKTtcbiAgfVxuICByZXR1cm4gZG9tTm9kZTtcbn07XG5cbmV4cG9ydCBjb25zdCBzZXRUZXh0Tm9kZSA9IHZhbCA9PiBub2RlID0+IG5vZGUudGV4dENvbnRlbnQgPSB2YWw7XG5cbmV4cG9ydCBjb25zdCBjcmVhdGVEb21Ob2RlID0gdm5vZGUgPT4ge1xuICByZXR1cm4gdm5vZGUubm9kZVR5cGUgPT09ICdUZXh0JyA/XG4gICAgZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoU3RyaW5nKHZub2RlLnByb3BzLnZhbHVlKSkgOlxuICAgIGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQodm5vZGUubm9kZVR5cGUpO1xufTtcblxuZXhwb3J0IGNvbnN0IGlzU2hhbGxvd0VxdWFsID0gKGEsIGIpID0+IHtcbiAgY29uc3QgYUtleXMgPSBPYmplY3Qua2V5cyhhKTtcbiAgY29uc3QgYktleXMgPSBPYmplY3Qua2V5cyhiKTtcbiAgcmV0dXJuIGFLZXlzLmxlbmd0aCA9PT0gYktleXMubGVuZ3RoICYmIGFLZXlzLmV2ZXJ5KChrKSA9PiBhW2tdID09PSBiW2tdKTtcbn07XG4iLCJpbXBvcnQge2NvbXBvc2V9IGZyb20gJ3NtYXJ0LXRhYmxlLW9wZXJhdG9ycyc7XG5pbXBvcnQge1xuICB1cHNlcnRDaGlsZCxcbiAgcmVtb3ZlQXR0cmlidXRlcyxcbiAgc2V0QXR0cmlidXRlcyxcbiAgaXNTaGFsbG93RXF1YWwsXG4gIHNldFRleHROb2RlLFxuICBjcmVhdGVEb21Ob2RlLFxuICByZW1vdmVFdmVudExpc3RlbmVycyxcbiAgYWRkRXZlbnRMaXN0ZW5lcnNcblxufSBmcm9tICcuL3V0aWwnO1xuXG4vL3RoZSBkb21Ob2RlIHBhcmVudCBvZiB0aGUgZXZlbnR1YWwgY2hpbGROb2RlIHJlcHJlc2VudGVkIGJ5IGEgdmlydHVhbCBub2RlLlxuLy8gb2xkTm9kZSBiZWluZyB0aGUgb2xkIHZlcnNpb24gb2YgdGhlIHZpcnR1YWwgbm9kZSwgbmV3Tm9kZSB0aGUgY3VycmVudCB2ZXJzaW9uXG5mdW5jdGlvbiB0b0RvbSAocGFyZW50RG9tLCBvbGROb2RlLCBuZXdOb2RlLCBkb21GYWN0b3J5KSB7XG4gIGxldCBkb21Ob2RlO1xuICBsZXQgZ2FyYmFnZSA9IG51bGw7XG4gIGlmIChuZXdOb2RlKSB7XG4gICAgaWYgKCFvbGROb2RlIHx8IG9sZE5vZGUubm9kZVR5cGUgIT09IG5ld05vZGUubm9kZVR5cGUpIHtcbiAgICAgIGRvbU5vZGUgPSBkb21GYWN0b3J5KG5ld05vZGUpO1xuICAgICAgY29uc3QgZGlmZiA9IHVwc2VydENoaWxkKHBhcmVudERvbSwgZG9tTm9kZSwgb2xkTm9kZSAmJiBvbGROb2RlLmRvbSkgfHwgbnVsbDtcbiAgICAgIGdhcmJhZ2UgPSBvbGROb2RlICYmIGRpZmYgPT09IG9sZE5vZGUuZG9tID8gb2xkTm9kZSA6IG51bGw7XG4gICAgICBuZXdOb2RlLmRvbSA9IGRvbU5vZGU7XG4gICAgfVxuICAgIG5ld05vZGUuZG9tID0gbmV3Tm9kZS5kb20gfHwgb2xkTm9kZS5kb207XG4gIH0gZWxzZSBpZiAob2xkTm9kZSkge1xuICAgIHBhcmVudERvbS5yZW1vdmVDaGlsZChvbGROb2RlLmRvbSk7XG4gICAgZ2FyYmFnZSA9IG9sZE5vZGU7XG4gIH1cbiAgcmV0dXJuIG5ld05vZGUgPyB7ZG9tTm9kZTogbmV3Tm9kZS5kb20sIGdhcmJhZ2V9IDoge2dhcmJhZ2V9O1xufVxuXG4vL3JldHVybiBhIGZ1bmN0aW9uIG9wZXJhdGluZyBvbiBET00gbm9kZXMgYmFzZWQgb24gdm5vZGUgcHJvcHMgZGlmZmluZ1xuZnVuY3Rpb24gdXBkYXRlQXR0cmlidXRlcyAobmV3Vk5vZGUsIG9sZFZOb2RlKSB7XG4gIGNvbnN0IG5ld1ZOb2RlUHJvcHMgPSBuZXdWTm9kZS5wcm9wcyB8fCB7fTtcbiAgY29uc3Qgb2xkVk5vZGVQcm9wcyA9IG9sZFZOb2RlLnByb3BzIHx8IHt9O1xuICBjb25zdCBuZXdOb2RlRXZlbnRzID0gbmV3Vk5vZGUuZXZlbnRzIHx8IHt9O1xuICBjb25zdCBvbGROb2RlRXZlbnRzID0gb2xkVk5vZGUuZXZlbnRzIHx8IHt9O1xuXG4gIGlmIChpc1NoYWxsb3dFcXVhbChuZXdWTm9kZVByb3BzLCBvbGRWTm9kZVByb3BzKSkge1xuICAgIHJldHVybiAoKSA9PiB7LyogZG8gbm90aGluZyAqL1xuICAgIH07XG4gIH1cblxuICBpZiAobmV3Vk5vZGUubm9kZVR5cGUgPT09ICdUZXh0Jykge1xuICAgIHJldHVybiBzZXRUZXh0Tm9kZShuZXdWTm9kZS5wcm9wcy52YWx1ZSk7XG4gIH1cblxuICBjb25zdCBuZXdOb2RlS2V5cyA9IE9iamVjdC5rZXlzKG5ld1ZOb2RlUHJvcHMpO1xuICBjb25zdCBvbGROb2RlS2V5cyA9IE9iamVjdC5rZXlzKG9sZFZOb2RlUHJvcHMpO1xuICBjb25zdCB0b1JlbW92ZSA9IG9sZE5vZGVLZXlzLmZpbHRlcihrID0+ICFuZXdOb2RlS2V5cy5pbmNsdWRlcyhrKSk7XG5cbiAgY29uc3QgcGFpcmlmeSA9IGhvbGRlciA9PiBrZXkgPT4gW2tleSwgaG9sZGVyW2tleV1dO1xuXG4gIHJldHVybiBjb21wb3NlKFxuICAgIHJlbW92ZUV2ZW50TGlzdGVuZXJzKC4uLk9iamVjdC5rZXlzKG9sZE5vZGVFdmVudHMpLm1hcChwYWlyaWZ5KG9sZE5vZGVFdmVudHMpKSksXG4gICAgcmVtb3ZlQXR0cmlidXRlcyguLi50b1JlbW92ZSksXG4gICAgc2V0QXR0cmlidXRlcyguLi5uZXdOb2RlS2V5cy5tYXAocGFpcmlmeShuZXdWTm9kZVByb3BzKSkpLFxuICAgIGFkZEV2ZW50TGlzdGVuZXJzKC4uLk9iamVjdC5rZXlzKG5ld05vZGVFdmVudHMpLm1hcChwYWlyaWZ5KG5ld05vZGVFdmVudHMpKSlcbiAgKTtcbn1cblxuLy8gdXBkYXRlIGEgZG9tIG5vZGUgYW5kIGl0cyBkZXNjZW5kYW50IGJhc2VkIG9uIGl0cyB2aXJ0dWFsIG5vZGUgcmVwcmVzZW50YXRpb25cbi8vIG9sZE5vZGUgYmVpbmcgdGhlIG9sZCB2ZXJzaW9uIG9mIHRoZSB2aXJ0dWFsIG5vZGUsIG5ld05vZGUgdGhlIGN1cnJlbnQgdmVyc2lvblxuZXhwb3J0IGZ1bmN0aW9uIHVwZGF0ZVRyZWUgKHBhcmVudERvbSwgb2xkTm9kZSwgbmV3Tm9kZSwgZG9tRmFjdG9yeSA9IGNyZWF0ZURvbU5vZGUpIHtcblxuICBsZXQgZ2FyYmFnZUNvbGxlY3RvciA9IFtdO1xuICBjb25zdCB0ZW1wT2xkTm9kZSA9IG9sZE5vZGUgPyBvbGROb2RlIDoge2xlbmd0aDogMCwgY2hpbGRyZW46IFtdfTtcblxuICAvLzEuIGdldCB0aGUgYWN0dWFsIGRvbSBlbGVtZW50IHJlbGF0ZWQgdG8gdmlydHVhbCBkb20gZGlmZiAmJiBjb2xsZWN0IG5vZGUgdG8gcmVtb3ZlL2NsZWFuXG4gIGNvbnN0IHtkb21Ob2RlLCBnYXJiYWdlfSA9IHRvRG9tKHBhcmVudERvbSwgb2xkTm9kZSwgbmV3Tm9kZSwgZG9tRmFjdG9yeSk7XG5cbiAgaWYgKGdhcmJhZ2UgIT09IG51bGwpIHtcbiAgICBnYXJiYWdlQ29sbGVjdG9yLnB1c2goZ2FyYmFnZSk7XG4gIH1cblxuICAvLzIuIHVwZGF0ZSBhdHRyaWJ1dGVzXG4gIGlmIChkb21Ob2RlKSB7XG4gICAgY29uc3QgdXBkYXRlRnVuYyA9IHVwZGF0ZUF0dHJpYnV0ZXMobmV3Tm9kZSwgdGVtcE9sZE5vZGUpO1xuICAgIHVwZGF0ZUZ1bmMoZG9tTm9kZSk7XG5cbiAgICAvLzMgcmVjdXJzaXZlbHkgZG8gdGhlIHNhbWUgZm9yIGNoaWxkcmVuXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBNYXRoLm1heCh0ZW1wT2xkTm9kZS5sZW5ndGgsIG5ld05vZGUubGVuZ3RoKTsgaSsrKSB7XG4gICAgICBnYXJiYWdlQ29sbGVjdG9yID0gZ2FyYmFnZUNvbGxlY3Rvci5jb25jYXQodXBkYXRlVHJlZShkb21Ob2RlLCB0ZW1wT2xkTm9kZS5jaGlsZHJlbltpXSwgbmV3Tm9kZS5jaGlsZHJlbltpXSwgZG9tRmFjdG9yeSkpO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiBnYXJiYWdlQ29sbGVjdG9yO1xufSIsImltcG9ydCB7Y3JlYXRlRG9tTm9kZX0gZnJvbSAnLi91dGlsJztcblxuLy8gaWYgeW91IGhhdmUgc3BlY2lmaWMgbWVtb3J5IHJlcXVpcmVtZW50OlxuLy8gdGhpcyBpbnN0YW5jZSB3aWxsIGNsZWFuIGFuZCByZXVzZSBkb20gbm9kZXNcbi8vIGluc3RlYWQgb2YgdGhyb3dpbmcgdGhlbSBhbmQgcmVjcmVhdGluZyBuZXcgb25lc1xuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gKCkge1xuXG4gIGNvbnN0IHBvb2wgPSB7fTtcblxuICBjb25zdCByZWN5Y2xlciA9IHtcbiAgICBjcmVhdGUodm5vZGUpe1xuICAgICAgY29uc3QgcCA9IHBvb2xbdm5vZGUubm9kZVR5cGVdIHx8IFtdO1xuICAgICAgY29uc3QgdCA9IHAuc2hpZnQoKTtcbiAgICAgIHJldHVybiB0IHx8IGNyZWF0ZURvbU5vZGUodm5vZGUpO1xuICAgIH0sXG4gICAgY29sbGVjdChnYXJiYWdlKXtcbiAgICAgIGZvciAobGV0IHZub2RlIG9mIGdhcmJhZ2UpIHtcbiAgICAgICAgY29uc3QgZG9tID0gdm5vZGUuZG9tO1xuICAgICAgICAvL3RvZG8gY2xlYW4gZG9tIG5vZGUgZXZlbnQgbGlzdGVuZXJzIGV0Y1xuICAgICAgICB2bm9kZS5kb20gPSBudWxsO1xuICAgICAgICBwb29sW3Zub2RlLm5vZGVUeXBlXSA9IHBvb2xbdm5vZGUubm9kZVR5cGVdIHx8IFtdO1xuICAgICAgICBwb29sW3Zub2RlLm5vZGVUeXBlXS5wdXNoKGRvbSk7XG4gICAgICAgIHJlY3ljbGVyLmNvbGxlY3Qodm5vZGUuY2hpbGRyZW4pO1xuICAgICAgfVxuICAgIH1cbiAgfTtcbiAgcmV0dXJuIHJlY3ljbGVyO1xufSIsImltcG9ydCBoIGZyb20gJy4vbGliL2gnXG5pbXBvcnQge3VwZGF0ZVRyZWV9IGZyb20gJy4vbGliL3JlbmRlcic7XG5pbXBvcnQgcmVjeWNsZXJGYWN0b3J5IGZyb20gJy4vbGliL3JlY3ljbGVyJztcblxuZnVuY3Rpb24gaXRlbWlmeSAoc3RyaW5nKSB7XG4gIGNvbnN0IGl0ZW1zID0gW107XG4gIGNvbnN0IG51bWJlcnMgPSBNYXRoLmNlaWwoTWF0aC5yYW5kb20oKSAqIDEwMDApO1xuICBjb25zb2xlLmxvZyhudW1iZXJzKVxuICBmb3IgKGxldCBpID0gMDsgaSA8IG51bWJlcnM7IGkrKykge1xuICAgIGl0ZW1zLnB1c2goe2lkOiBpLCB2YWx1ZTogc3RyaW5nICsgaSArICcgJyArIERhdGUubm93KCl9KTtcbiAgfVxuXG4gIHJldHVybiBpdGVtcztcbn1cblxuY29uc3QgSXRlbSA9ICh7aXRlbSwgY2hpbGRyZW59KSA9PiAoPGxpIGlkPXtpdGVtLmlkfT57Y2hpbGRyZW59PC9saT4pO1xuXG5jb25zdCBkaXYgPSAoe3RpdGxlLCBpdGVtcyA9IFtdfSkgPT4gKFxuICA8ZGl2PlxuICAgIDx1bD5cbiAgICAgIHtcbiAgICAgICAgaXRlbXMubWFwKGl0ZW0gPT4gKDxJdGVtIGl0ZW09e2l0ZW19PntpdGVtLnZhbHVlfTwvSXRlbT4pKVxuICAgICAgfVxuICAgIDwvdWw+XG4gIDwvZGl2Pik7XG5cbmxldCBtYWluRWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtYWluJyk7XG5jb25zb2xlLnRpbWUoJ3NldCcpO1xubGV0IG9sZFZub2RlID0gZGl2KHtpdGVtczogaXRlbWlmeSgnZm9vJyl9KTtcbmNvbnN0IG1haW4gPSB1cGRhdGVUcmVlKG1haW5FbGVtZW50LCBudWxsLCBvbGRWbm9kZSk7XG5jb25zb2xlLnRpbWVFbmQoJ3NldCcpO1xuXG5jb25zdCByZWN5Y2xlciA9IHJlY3ljbGVyRmFjdG9yeSgpO1xuXG5jb25zdCBbYl0gPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSgnYnV0dG9uJyk7XG5iLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICBjb25zb2xlLnRpbWUoJ3VwZGF0ZScpO1xuICBjb25zdCBuZXdWbm9kZSA9IGRpdih7aXRlbXM6IGl0ZW1pZnkoJ3VwZGF0ZWQgYXQnKX0pO1xuICBjb25zdCBnYXJiYWdlID0gdXBkYXRlVHJlZShtYWluRWxlbWVudCwgb2xkVm5vZGUsIG5ld1Zub2RlLCByZWN5Y2xlci5jcmVhdGUpO1xuICBvbGRWbm9kZSA9IG5ld1Zub2RlO1xuICBjb25zb2xlLnRpbWVFbmQoJ3VwZGF0ZScpO1xuICByZWN5Y2xlci5jb2xsZWN0KGdhcmJhZ2UgfHwgW10pO1xufSk7XG5cblxuXG5cbiJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7QUFBZSxTQUFTLENBQUMsRUFBRSxRQUFRLEVBQUUsS0FBSyxFQUFFLEdBQUcsUUFBUSxFQUFFO0VBQ3ZELE1BQU0sWUFBWSxHQUFHLFFBQVEsQ0FBQyxNQUFNLENBQUMsQ0FBQyxHQUFHLEVBQUUsS0FBSyxLQUFLO0lBQ25ELE1BQU0sYUFBYSxHQUFHLEtBQUssQ0FBQyxPQUFPLENBQUMsS0FBSyxDQUFDLEdBQUcsS0FBSyxHQUFHLENBQUMsS0FBSyxDQUFDLENBQUM7SUFDN0QsT0FBTyxHQUFHLENBQUMsTUFBTSxDQUFDLGFBQWEsQ0FBQyxDQUFDO0dBQ2xDLEVBQUUsRUFBRSxDQUFDO0tBQ0gsR0FBRyxDQUFDLEtBQUssSUFBSTs7TUFFWixNQUFNLENBQUMsR0FBRyxPQUFPLEtBQUssQ0FBQztNQUN2QixPQUFPLENBQUMsS0FBSyxVQUFVLElBQUksQ0FBQyxLQUFL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
