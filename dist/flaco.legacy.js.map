{"version":3,"file":"flaco.legacy.js","sources":["../lib/h.js","../node_modules/smart-table-operators/index.js","../lib/util.js","../lib/domUtil.js","../lib/traverse.legacy.js","../lib/tree.js","../lib/update.js","../lib/lifeCycles.js","../lib/withState.js","../lib/elm.js","../lib/connect.js"],"sourcesContent":["const createTextVNode = (value) => ({\n  nodeType: 'Text',\n  children: [],\n  props: {value}\n});\n\n/**\n * Transform hyperscript into virtual dom node\n * @param nodeType\n * @param props\n * @param children\n * @returns {*}\n */\nexport default function h (nodeType, props, ...children) {\n  const flatChildren = children.reduce((acc, child) => {\n    const childrenArray = Array.isArray(child) ? child : [child];\n    return acc.concat(childrenArray);\n  }, [])\n    .map(child => {\n      // normalize text node to have same structure than regular dom nodes\n      const type = typeof child;\n      return type === 'object' || type === 'function' ? child : createTextVNode(child);\n    });\n\n  if (typeof nodeType !== 'function') {//regular html/text node\n    return {\n      nodeType,\n      props: props,\n      children: flatChildren\n    };\n  } else {\n    const fullProps = Object.assign({children: flatChildren}, props);\n    const comp = nodeType(fullProps);\n    return typeof comp !== 'function' ? comp : h(comp, props, ...flatChildren); //functional comp vs combinator (HOC)\n  }\n};","export function swap (f) {\n  return (a, b) => f(b, a);\n}\n\nexport function compose (first, ...fns) {\n  return (...args) => fns.reduce((previous, current) => current(previous), first(...args));\n}\n\nexport function curry (fn, arityLeft) {\n  const arity = arityLeft || fn.length;\n  return (...args) => {\n    const argLength = args.length || 1;\n    if (arity === argLength) {\n      return fn(...args);\n    } else {\n      const func = (...moreArgs) => fn(...args, ...moreArgs);\n      return curry(func, arity - args.length);\n    }\n  };\n}\n\nexport function apply (fn) {\n  return (...args) => fn(...args);\n}\n\nexport function tap (fn) {\n  return arg => {\n    fn(arg);\n    return arg;\n  }\n}","export const nextTick = fn => setTimeout(fn, 0);\n\nexport const pairify = holder => key => [key, holder[key]];\n\nexport const isShallowEqual = (a, b) => {\n  const aKeys = Object.keys(a);\n  const bKeys = Object.keys(b);\n  return aKeys.length === bKeys.length && aKeys.every((k) => a[k] === b[k]);\n};\n\nconst ownKeys = obj => Object.keys(obj).filter(k => obj.hasOwnProperty(k));\n\nexport const isDeepEqual = (a, b) => {\n  const type = typeof a;\n\n  //short path(s)\n  if (a === b) {\n    return true;\n  }\n\n  if (type !== typeof b) {\n    return false;\n  }\n\n  if (type !== 'object') {\n    return a === b;\n  }\n\n  // objects ...\n  if (a === null || b === null) {\n    return false;\n  }\n\n  if (Array.isArray(a)) {\n    return a.length && b.length && a.every((item, i) => isDeepEqual(a[i], b[i]));\n  }\n\n  const aKeys = ownKeys(a);\n  const bKeys = ownKeys(b);\n  return aKeys.length === bKeys.length && aKeys.every(k => isDeepEqual(a[k], b[k]));\n};\n\nexport const identity = p => p;\n\nexport const noop = () => {\n};\n","import {tap} from 'smart-table-operators';\n\nconst updateDomNodeFactory = (method) => (items) => tap(domNode => {\n  for (let pair of items) {\n    domNode[method](...pair);\n  }\n});\n\nexport const removeEventListeners = updateDomNodeFactory('removeEventListener');\nexport const addEventListeners = updateDomNodeFactory('addEventListener');\nexport const setAttributes = (items) => tap((domNode) => {\n  const attributes = items.filter(([key, value]) => typeof value !== 'function');\n  for (let [key, value] of attributes) {\n    value === false ? domNode.removeAttribute(key) : domNode.setAttribute(key, value);\n  }\n});\nexport const removeAttributes = (items) => tap(domNode => {\n  for (let attr of items) {\n    domNode.removeAttribute(attr);\n  }\n});\n\nexport const setTextNode = val => node => node.textContent = val;\n\nexport const createDomNode = vnode => {\n  return vnode.nodeType !== 'Text' ?\n    document.createElement(vnode.nodeType) :\n    document.createTextNode(String(vnode.props.value));\n};\n\nexport const getEventListeners = (props) => {\n  return Object.keys(props)\n    .filter(k => k.substr(0, 2) === 'on')\n    .map(k => [k.substr(2).toLowerCase(), props[k]]);\n};\n","/**\n * generator free version of ./traverse.js\n * @param vnode\n * @returns {Array}\n */\nexport const traverse = function (vnode) {\n  const output = [];\n  output.push(vnode);\n  if (vnode.children && vnode.children.length) {\n    for (let child of vnode.children) {\n      output.push(...traverse(child));\n    }\n  }\n  return output;\n};\n","import {compose, curry} from 'smart-table-operators';\nimport {\n  isShallowEqual,\n  pairify,\n  nextTick,\n  noop\n} from './util';\nimport {\n  removeAttributes,\n  setAttributes,\n  setTextNode,\n  createDomNode,\n  removeEventListeners,\n  addEventListeners,\n  getEventListeners,\n} from './domUtil';\nimport {traverse} from './traverse';\n\nfunction updateEventListeners ({props:newNodeProps}={}, {props:oldNodeProps}={}) {\n  const newNodeEvents = getEventListeners(newNodeProps || {});\n  const oldNodeEvents = getEventListeners(oldNodeProps || {});\n\n  return newNodeEvents.length || oldNodeEvents.length ?\n    compose(\n      removeEventListeners(oldNodeEvents),\n      addEventListeners(newNodeEvents)\n    ) : noop;\n}\n\nfunction updateAttributes (newVNode, oldVNode) {\n  const newVNodeProps = newVNode.props || {};\n  const oldVNodeProps = oldVNode.props || {};\n\n  if (isShallowEqual(newVNodeProps, oldVNodeProps)) {\n    return noop;\n  }\n\n  if (newVNode.nodeType === 'Text') {\n    return setTextNode(newVNode.props.value);\n  }\n\n  const newNodeKeys = Object.keys(newVNodeProps);\n  const oldNodeKeys = Object.keys(oldVNodeProps);\n  const attributesToRemove = oldNodeKeys.filter(k => !newNodeKeys.includes(k));\n\n  return compose(\n    removeAttributes(attributesToRemove),\n    setAttributes(newNodeKeys.map(pairify(newVNodeProps)))\n  );\n}\n\nconst domFactory = createDomNode;\n\n// apply vnode diffing to actual dom node (if new node => it will be mounted into the parent)\nconst domify = function updateDom (oldVnode, newVnode, parentDomNode) {\n  if (!oldVnode) {//there is no previous vnode\n    if (newVnode) {//new node => we insert\n      newVnode.dom = parentDomNode.appendChild(domFactory(newVnode));\n      newVnode.lifeCycle = 1;\n      return {vnode: newVnode, garbage: null};\n    } else {//else (irrelevant)\n      throw new Error('unsupported operation')\n    }\n  } else {//there is a previous vnode\n    if (!newVnode) {//we must remove the related dom node\n      parentDomNode.removeChild(oldVnode.dom);\n      return ({garbage: oldVnode, dom: null});\n    } else if (newVnode.nodeType !== oldVnode.nodeType) {//it must be replaced\n      newVnode.dom = domFactory(newVnode);\n      newVnode.lifeCycle = 1;\n      parentDomNode.replaceChild(newVnode.dom, oldVnode.dom);\n      return {garbage: oldVnode, vnode: newVnode};\n    } else {// only update attributes\n      newVnode.dom = oldVnode.dom;\n      newVnode.lifeCycle = oldVnode.lifeCycle + 1;\n      return {garbage: null, vnode: newVnode};\n    }\n  }\n};\n\n/**\n * render a virtual dom node, diffing it with its previous version, mounting it in a parent dom node\n * @param oldVnode\n * @param newVnode\n * @param parentDomNode\n * @param onNextTick collect operations to be processed on next tick\n * @returns {Array}\n */\nexport const render = function renderer (oldVnode, newVnode, parentDomNode, onNextTick = []) {\n\n  //1. transform the new vnode to a vnode connected to an actual dom element based on vnode versions diffing\n  // i. note at this step occur dom insertions/removals\n  // ii. it may collect sub tree to be dropped (or \"unmounted\")\n  const {vnode, garbage} = domify(oldVnode, newVnode, parentDomNode);\n\n  if (garbage !== null) {\n    // defer un mount lifecycle as it is not \"visual\"\n    for (let g of traverse(garbage)) {\n      if (g.onUnMount) {\n        onNextTick.push(g.onUnMount);\n      }\n    }\n  }\n\n  //Normalisation of old node (in case of a replace we will consider old node as empty node (no children, no props))\n  const tempOldNode = garbage !== null || !oldVnode ? {length: 0, children: [], props: {}} : oldVnode;\n\n  if (vnode) {\n\n    //2. update dom attributes based on vnode prop diffing.\n    //sync\n\n    if (vnode.onUpdate && vnode.lifeCycle > 1) {\n      vnode.onUpdate();\n    }\n\n    updateAttributes(vnode, tempOldNode)(vnode.dom);\n\n    //fast path\n    if (vnode.nodeType === 'Text') {\n      return onNextTick;\n    }\n\n    if (vnode.onMount && vnode.lifeCycle === 1) {\n      onNextTick.push(() => vnode.onMount());\n    }\n\n    const childrenCount = Math.max(tempOldNode.children.length, vnode.children.length);\n\n    //async will be deferred as it is not \"visual\"\n    const setListeners = updateEventListeners(vnode, tempOldNode);\n    if (setListeners !== noop) {\n      onNextTick.push(() => setListeners(vnode.dom));\n    }\n\n    //3 recursively traverse children to update dom and collect functions to process on next tick\n    if (childrenCount > 0) {\n      for (let i = 0; i < childrenCount; i++) {\n        // we pass onNextTick as reference (improve perf: memory + speed)\n        render(tempOldNode.children[i], vnode.children[i], vnode.dom, onNextTick);\n      }\n    }\n  }\n\n  return onNextTick;\n};\n\nexport const mount = curry(function (comp, initProp, root) {\n  const vnode = comp(initProp || {});\n  const batch = render(null, vnode, root);\n  nextTick(function () {\n    for (let op of batch) {\n      op();\n    }\n  });\n  return vnode;\n});","import {render} from './tree';\nimport {nextTick} from './util';\n\n/**\n * Create a function which will trigger an update of the component with the passed state\n * @param comp\n * @param initialVNode\n * @returns {function(*=, ...[*])}\n */\nexport default function update (comp, initialVNode) {\n  let oldNode = initialVNode;\n  const updateFunc = (props, ...args) => {\n    const mount = oldNode.dom.parentNode;\n    const newNode = comp(Object.assign({children: oldNode.children || []}, oldNode.props, props), ...args);\n    const nextBatch = render(oldNode, newNode, mount);\n\n    // danger zone !!!!\n    // change by keeping the same reference so the eventual parent node does not need to be \"aware\" tree may have changed downstream: oldNode may be the child of someone ...(well that is a tree data structure after all :P )\n    oldNode = Object.assign(oldNode || {}, newNode);\n    // end danger zone\n\n    nextTick(function () {\n      for (let op of nextBatch) {\n        op();\n      }\n    });\n    return newNode;\n  };\n  return updateFunc;\n}","import {curry} from 'smart-table-operators';\n\nconst lifeCycleFactory = method => curry((fn, comp) => (props, ...args) => {\n  const n = comp(props, ...args);\n  n[method] = () => fn(n, ...args);\n  return n;\n});\n\n/**\n * life cycle: when the component is mounted\n */\nexport const onMount = lifeCycleFactory('onMount');\n\n/**\n * life cycle: when the component is unmounted\n */\nexport const onUnMount = lifeCycleFactory('onUnMount');\n\nexport const onUpdate = lifeCycleFactory('onUpdate');","import update from './update';\nimport {onMount, onUpdate} from './lifeCycles';\nimport {compose} from 'smart-table-operators';\n\n/**\n * Combinator to create a \"stateful component\": ie it will have its own state and the ability to update its own tree\n * @param comp\n * @returns {Function}\n */\nexport default function (comp) {\n  return function () {\n    let updateFunc;\n    const wrapperComp = (props, ...args) => {\n      //lazy evaluate updateFunc (to make sure it is defined\n      const setState = (newState) => updateFunc(newState);\n      return comp(props, setState, ...args);\n    };\n    const setUpdateFunction = (vnode) => {\n      updateFunc = update(wrapperComp, vnode);\n    };\n\n    return compose(onMount(setUpdateFunction), onUpdate(setUpdateFunction))(wrapperComp);\n  };\n};","import update from './update';\nimport {onMount} from './lifeCycles';\nimport {compose} from 'smart-table-operators';\n\n//todo throw this in favor of connect only ?\n\n/**\n * Combinator to create a Elm like app\n * @param view\n */\nexport default function (view) {\n  return function ({model, updates, subscriptions = []}) {\n    let actionStore = {};\n\n    const comp = props => view(model, actionStore);\n\n    const initActionStore = (vnode) => {\n      const updateFunc = update(comp, vnode);\n      for (let update of Object.keys(updates)) {\n        actionStore[update] = (...args) => {\n          model = updates[update](model, ...args); //todo consider side effects, middlewares, etc\n          return updateFunc(model, actionStore);\n        }\n      }\n    };\n    const initSubscription = subscriptions.map(sub => vnode => sub(vnode, actionStore));\n    const initFunc = compose(initActionStore, ...initSubscription);\n\n    return onMount(initFunc, comp);\n  };\n};\n\n\n/*\n\nconnect(store, actions, watcher)\n\n\n\n\n */","import update from './update';\nimport {compose, curry} from 'smart-table-operators';\nimport {onMount, onUnMount} from './lifeCycles'\nimport {isDeepEqual, identity} from './util';\n\n/**\n * Connect combinator: will create \"container\" component which will subscribe to a Redux like store. and update its children whenever a specific slice of state change\n */\nexport default function (store, actions = {}, sliceState = identity) {\n  return function (comp, mapStateToProp = identity, shouldUpate = (a, b) => !isDeepEqual(a, b)) {\n    return function (initProp) {\n      let updateFunc;\n      let previousStateSlice;\n      let componentProps = initProp;\n      let unsubscriber;\n\n      const wrapperComp = (props, ...args) => {\n        return comp(props, actions, ...args);\n      };\n\n      const subscribe = onMount((vnode) => {\n        updateFunc = update(wrapperComp, vnode);\n        unsubscriber = store.subscribe(() => {\n          const stateSlice = sliceState(store.getState());\n          if (shouldUpate(previousStateSlice, stateSlice)) {\n            Object.assign(componentProps, mapStateToProp(stateSlice));\n            updateFunc(componentProps);\n            previousStateSlice = stateSlice;\n          }\n        });\n      });\n\n      const unsubscribe = onUnMount(() => {\n        unsubscriber();\n      });\n\n      return compose(subscribe, unsubscribe)(wrapperComp);\n    };\n  };\n};"],"names":["const","let","mount","update"],"mappings":"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"}