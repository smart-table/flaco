{"version":3,"file":"bundle.js","sources":["../../node_modules/smart-table-operators/index.js","../../lib/dom-util.js","../../lib/util.js","../../node_modules/deep-equal/lib/keys.js","../../node_modules/deep-equal/lib/is_arguments.js","../../node_modules/deep-equal/index.js","../../node_modules/zora/lib/assertions.js","../../node_modules/zora/lib/test.js","../../node_modules/zora/lib/tap.js","../../node_modules/zora/lib/combinators.js","../../node_modules/zora/index.js","../dom-util.js","../../lib/h.js","../../lib/traverse.js","../../lib/dom-renderer.js","../../lib/update.js","../../lib/lifecycles.js","../../lib/with-state.js","../../lib/hdom.js","../../lib/string-renderer.js","../h.js","../test-util.js","../lifecycles.js","../render.js","../update.js","../util.js","../with-state.js","../render-as-string.js"],"sourcesContent":["export const swap = f => (a, b) => f(b, a);\n\nexport const compose = (first, ...fns) => (...args) => fns.reduce((previous, current) => current(previous), first(...args));\n\nexport const curry = (fn, arityLeft) => {\n\tconst arity = arityLeft || fn.length;\n\treturn (...args) => {\n\t\tconst argLength = args.length || 1;\n\t\tif (arity === argLength) {\n\t\t\treturn fn(...args);\n\t\t}\n\t\tconst func = (...moreArgs) => fn(...args, ...moreArgs);\n\t\treturn curry(func, arity - args.length);\n\t};\n};\n\nexport const apply = fn => (...args) => fn(...args);\n\nexport const tap = fn => arg => {\n\tfn(arg);\n\treturn arg;\n};\n","import {tap} from 'smart-table-operators';\n\nconst SVG_NP = 'http://www.w3.org/2000/svg';\n\nconst updateDomNodeFactory = method => items => tap(domNode => {\n\tfor (const pair of items) {\n\t\tdomNode[method](...pair);\n\t}\n});\n\nexport const removeEventListeners = updateDomNodeFactory('removeEventListener');\n\nexport const addEventListeners = updateDomNodeFactory('addEventListener');\n\nexport const setAttributes = items => tap(domNode => {\n\tconst attributes = items.filter(([key, value]) => typeof value !== 'function');\n\tfor (const [key, value] of attributes) {\n\t\tif (value === false) {\n\t\t\tdomNode.removeAttribute(key);\n\t\t} else {\n\t\t\tdomNode.setAttribute(key, value);\n\t\t}\n\t}\n});\n\nexport const removeAttributes = items => tap(domNode => {\n\tfor (const attr of items) {\n\t\tdomNode.removeAttribute(attr);\n\t}\n});\n\nexport const setTextNode = val => node => {\n\tnode.textContent = val;\n};\n\nexport const createDomNode = (vnode, parent) => {\n\tif (vnode.nodeType === 'svg') {\n\t\treturn document.createElementNS(SVG_NP, vnode.nodeType);\n\t} else if (vnode.nodeType === 'Text') {\n\t\treturn document.createTextNode(vnode.nodeType);\n\t}\n\treturn parent.namespaceURI === SVG_NP ?\n\t\tdocument.createElementNS(SVG_NP, vnode.nodeType) :\n\t\tdocument.createElement(vnode.nodeType);\n};\n\nexport const getEventListeners = props => Object.keys(props)\n\t.filter(k => k.substr(0, 2) === 'on')\n\t.map(k => [k.substr(2).toLowerCase(), props[k]]);\n","export const nextTick = fn => setTimeout(fn, 0);\n\nexport const pairify = holder => key => [key, holder[key]];\n\nexport const isShallowEqual = (a, b) => {\n\tconst aKeys = Object.keys(a);\n\tconst bKeys = Object.keys(b);\n\treturn aKeys.length === bKeys.length && aKeys.every(k => a[k] === b[k]);\n};\n\nconst ownKeys = obj => Object.getOwnPropertyNames(obj);\n\nexport const isDeepEqual = (a, b) => {\n\tconst type = typeof a;\n\tconst typeB = typeof b;\n\n\t// Short path(s)\n\tif (a === b) {\n\t\treturn true;\n\t}\n\n\tif (type !== typeB) {\n\t\treturn false;\n\t}\n\n\tif (type !== 'object') {\n\t\treturn a === b;\n\t}\n\n\t// Objects ...\n\tif (a === null || b === null) {\n\t\treturn false;\n\t}\n\n\tif (Array.isArray(a)) {\n\t\treturn a.length && b.length && a.every((item, i) => isDeepEqual(a[i], b[i]));\n\t}\n\n\tconst aKeys = ownKeys(a);\n\tconst bKeys = ownKeys(b);\n\treturn aKeys.length === bKeys.length && aKeys.every(k => isDeepEqual(a[k], b[k]));\n};\n\nexport const noop = () => {};\n","exports = module.exports = typeof Object.keys === 'function'\n  ? Object.keys : shim;\n\nexports.shim = shim;\nfunction shim (obj) {\n  var keys = [];\n  for (var key in obj) keys.push(key);\n  return keys;\n}\n","var supportsArgumentsClass = (function(){\n  return Object.prototype.toString.call(arguments)\n})() == '[object Arguments]';\n\nexports = module.exports = supportsArgumentsClass ? supported : unsupported;\n\nexports.supported = supported;\nfunction supported(object) {\n  return Object.prototype.toString.call(object) == '[object Arguments]';\n};\n\nexports.unsupported = unsupported;\nfunction unsupported(object){\n  return object &&\n    typeof object == 'object' &&\n    typeof object.length == 'number' &&\n    Object.prototype.hasOwnProperty.call(object, 'callee') &&\n    !Object.prototype.propertyIsEnumerable.call(object, 'callee') ||\n    false;\n};\n","var pSlice = Array.prototype.slice;\nvar objectKeys = require('./lib/keys.js');\nvar isArguments = require('./lib/is_arguments.js');\n\nvar deepEqual = module.exports = function (actual, expected, opts) {\n  if (!opts) opts = {};\n  // 7.1. All identical values are equivalent, as determined by ===.\n  if (actual === expected) {\n    return true;\n\n  } else if (actual instanceof Date && expected instanceof Date) {\n    return actual.getTime() === expected.getTime();\n\n  // 7.3. Other pairs that do not both pass typeof value == 'object',\n  // equivalence is determined by ==.\n  } else if (!actual || !expected || typeof actual != 'object' && typeof expected != 'object') {\n    return opts.strict ? actual === expected : actual == expected;\n\n  // 7.4. For all other Object pairs, including Array objects, equivalence is\n  // determined by having the same number of owned properties (as verified\n  // with Object.prototype.hasOwnProperty.call), the same set of keys\n  // (although not necessarily the same order), equivalent values for every\n  // corresponding key, and an identical 'prototype' property. Note: this\n  // accounts for both named and indexed properties on Arrays.\n  } else {\n    return objEquiv(actual, expected, opts);\n  }\n}\n\nfunction isUndefinedOrNull(value) {\n  return value === null || value === undefined;\n}\n\nfunction isBuffer (x) {\n  if (!x || typeof x !== 'object' || typeof x.length !== 'number') return false;\n  if (typeof x.copy !== 'function' || typeof x.slice !== 'function') {\n    return false;\n  }\n  if (x.length > 0 && typeof x[0] !== 'number') return false;\n  return true;\n}\n\nfunction objEquiv(a, b, opts) {\n  var i, key;\n  if (isUndefinedOrNull(a) || isUndefinedOrNull(b))\n    return false;\n  // an identical 'prototype' property.\n  if (a.prototype !== b.prototype) return false;\n  //~~~I've managed to break Object.keys through screwy arguments passing.\n  //   Converting to array solves the problem.\n  if (isArguments(a)) {\n    if (!isArguments(b)) {\n      return false;\n    }\n    a = pSlice.call(a);\n    b = pSlice.call(b);\n    return deepEqual(a, b, opts);\n  }\n  if (isBuffer(a)) {\n    if (!isBuffer(b)) {\n      return false;\n    }\n    if (a.length !== b.length) return false;\n    for (i = 0; i < a.length; i++) {\n      if (a[i] !== b[i]) return false;\n    }\n    return true;\n  }\n  try {\n    var ka = objectKeys(a),\n        kb = objectKeys(b);\n  } catch (e) {//happens when one is a string literal and the other isn't\n    return false;\n  }\n  // having the same number of owned properties (keys incorporates\n  // hasOwnProperty)\n  if (ka.length != kb.length)\n    return false;\n  //the same set of keys (although not necessarily the same order),\n  ka.sort();\n  kb.sort();\n  //~~~cheap key test\n  for (i = ka.length - 1; i >= 0; i--) {\n    if (ka[i] != kb[i])\n      return false;\n  }\n  //equivalent values for every corresponding key, and\n  //~~~possibly expensive deep test\n  for (i = ka.length - 1; i >= 0; i--) {\n    key = ka[i];\n    if (!deepEqual(a[key], b[key], opts)) return false;\n  }\n  return typeof a === typeof b;\n}\n","import deepEqual from 'deep-equal';\n\nconst getAssertionLocation = () => {\n\tconst err = new Error();\n\tconst stack = (err.stack || '').split('\\n');\n\treturn (stack[3] || '').trim().replace(/^at/i, '');\n};\n\nconst assertMethodHook = fn => function (...args) {\n\tconst assertResult = fn(...args);\n\n\tif (assertResult.pass === false) {\n\t\tassertResult.at = getAssertionLocation();\n\t}\n\n\tthis.collect(assertResult);\n\treturn assertResult;\n};\n\nconst Assertion = {\n\tok: assertMethodHook((val, description = 'should be truthy') => ({\n\t\tpass: Boolean(val),\n\t\tactual: val,\n\t\texpected: true,\n\t\tdescription,\n\t\toperator: 'ok'\n\t})),\n\tdeepEqual: assertMethodHook((actual, expected, description = 'should be equivalent') => ({\n\t\tpass: deepEqual(actual, expected),\n\t\tactual,\n\t\texpected,\n\t\tdescription,\n\t\toperator: 'deepEqual'\n\t})),\n\tequal: assertMethodHook((actual, expected, description = 'should be equal') => ({\n\t\tpass: actual === expected,\n\t\tactual,\n\t\texpected,\n\t\tdescription,\n\t\toperator: 'equal'\n\t})),\n\tnotOk: assertMethodHook((val, description = 'should not be truthy') => ({\n\t\tpass: !val,\n\t\texpected: false,\n\t\tactual: val,\n\t\tdescription,\n\t\toperator: 'notOk'\n\t})),\n\tnotDeepEqual: assertMethodHook((actual, expected, description = 'should not be equivalent') => ({\n\t\tpass: !deepEqual(actual, expected),\n\t\tactual,\n\t\texpected,\n\t\tdescription,\n\t\toperator: 'notDeepEqual'\n\t})),\n\tnotEqual: assertMethodHook((actual, expected, description = 'should not be equal') => ({\n\t\tpass: actual !== expected,\n\t\tactual,\n\t\texpected,\n\t\tdescription,\n\t\toperator: 'notEqual'\n\t})),\n\tthrows: assertMethodHook((func, expected, description) => {\n\t\tlet caught;\n\t\tlet pass;\n\t\tlet actual;\n\t\tif (typeof expected === 'string') {\n\t\t\t[expected, description] = [description, expected];\n\t\t}\n\t\ttry {\n\t\t\tfunc();\n\t\t} catch (err) {\n\t\t\tcaught = {error: err};\n\t\t}\n\t\tpass = caught !== undefined;\n\t\tactual = caught && caught.error;\n\t\tif (expected instanceof RegExp) {\n\t\t\tpass = expected.test(actual) || expected.test(actual && actual.message);\n\t\t\tactual = actual && actual.message || actual;\n\t\t\texpected = String(expected);\n\t\t} else if (typeof expected === 'function' && caught) {\n\t\t\tpass = actual instanceof expected;\n\t\t\tactual = actual.constructor;\n\t\t}\n\t\treturn {\n\t\t\tpass,\n\t\t\texpected,\n\t\t\tactual,\n\t\t\toperator: 'throws',\n\t\t\tdescription: description || 'should throw'\n\t\t};\n\t}),\n\tdoesNotThrow: assertMethodHook((func, expected, description) => {\n\t\tlet caught;\n\t\tif (typeof expected === 'string') {\n\t\t\t[expected, description] = [description, expected];\n\t\t}\n\t\ttry {\n\t\t\tfunc();\n\t\t} catch (err) {\n\t\t\tcaught = {error: err};\n\t\t}\n\t\treturn {\n\t\t\tpass: caught === undefined,\n\t\t\texpected: 'no thrown error',\n\t\t\tactual: caught && caught.error,\n\t\t\toperator: 'doesNotThrow',\n\t\t\tdescription: description || 'should not throw'\n\t\t};\n\t}),\n\tfail: assertMethodHook((description = 'fail called') => ({\n\t\tpass: false,\n\t\tactual: 'fail called',\n\t\texpected: 'fail not called',\n\t\tdescription,\n\t\toperator: 'fail'\n\t}))\n};\n\nexport default (collect, test) => Object.assign(\n\tObject.create(Assertion, {collect: {value: collect}}), {\n\t\tasync test(description, spec) {\n\t\t\t// Note: we return the task so the caller can control whether he wants to wait for the sub test to complete or not\n\t\t\treturn test(description, spec).task;\n\t\t}\n\t});\n","import assert from './assertions';\n\nconst tester = (collect, {offset = 0} = {}) => (description, spec) => {\n\tconst buffer = [{type: 'title', data: description, offset}];\n\tconst result = {count: 0, pass: true, description, spec};\n\tlet done = false;\n\n\tconst createAssertion = item => {\n\t\tresult.pass = result.pass && item.pass;\n\t\treturn {type: 'assert', data: item, offset};\n\t};\n\n\tconst collector = item => {\n\t\tresult.count++;\n\t\titem.id = result.count;\n\t\tif (item[Symbol.asyncIterator] === undefined) {\n\t\t\t// Assertion\n\t\t\tbuffer.push(createAssertion(item));\n\t\t} else {\n\t\t\t// Sub test\n\t\t\tbuffer.push(item);\n\t\t}\n\t};\n\n\tconst handleDelegate = async delegate => {\n\t\tconst {value, done} = await delegate.next();\n\n\t\t// Delegate is exhausted: create a summary test point in the stream and throw the delegate\n\t\tif (done === true) {\n\t\t\tconst {executionTime, pass, description} = value;\n\t\t\tconst subTestAssertion = Object.assign(createAssertion({\n\t\t\t\tpass,\n\t\t\t\tdescription,\n\t\t\t\tid: delegate.id,\n\t\t\t\texecutionTime\n\t\t\t}), {type: 'testAssert'});\n\t\t\tbuffer.shift();\n\t\t\tbuffer.unshift(subTestAssertion);\n\t\t\treturn instance.next();\n\t\t}\n\t\treturn {value, done};\n\t};\n\n\tconst subTest = tester(collector, {offset: offset + 1});\n\n\tconst start = Date.now();\n\t// Execute the test collecting assertions\n\tconst assertFn = assert(collector, subTest);\n\tconst task = new Promise(resolve => resolve(spec(assertFn)))\n\t\t.then(() => {\n\t\t\t// Always report a plan and summary: the calling test will know how to deal with it\n\t\t\tresult.executionTime = Date.now() - start;\n\t\t\tbuffer.push({type: 'plan', data: {start: 1, end: result.count}, offset});\n\t\t\tbuffer.push({type: 'time', data: result.executionTime, offset});\n\t\t\tdone = true;\n\t\t\treturn result;\n\t\t})\n\t\t.catch(err => {\n\t\t\t// We report a failing test before bail out ... while unhandled promise rejection is still allowed by nodejs...\n\t\t\tbuffer.push({type: 'assert', data: {pass: false, description}});\n\t\t\tbuffer.push({type: 'comment', data: 'Unhandled exception'});\n\t\t\tbuffer.push({type: 'bailout', data: err, offset});\n\t\t\tdone = true;\n\t\t});\n\n\tconst instance = {\n\t\ttest: subTest,\n\t\ttask,\n\t\t[Symbol.asyncIterator]() {\n\t\t\treturn this;\n\t\t},\n\t\tasync next() {\n\t\t\tif (buffer.length === 0) {\n\t\t\t\tif (done === true) {\n\t\t\t\t\treturn {done: true, value: result};\n\t\t\t\t}\n\t\t\t\t// Flush\n\t\t\t\tawait task;\n\t\t\t\treturn this.next();\n\t\t\t}\n\n\t\t\tconst next = buffer[0];\n\n\t\t\t// Delegate if sub test\n\t\t\tif (next[Symbol.asyncIterator] !== undefined) {\n\t\t\t\treturn handleDelegate(next);\n\t\t\t}\n\n\t\t\treturn {value: buffer.shift(), done: false};\n\t\t}\n\t};\n\n\t// Collection by the calling test\n\tcollect(instance);\n\n\treturn instance;\n};\n\nexport default tester;\n","const print = (message, offset = 0) => {\n\tconsole.log(message.padStart(message.length + (offset * 4))); // 4 white space used as indent (see tap-parser)\n};\n\nconst toYaml = print => (obj, offset = 0) => {\n\tfor (const [prop, value] of Object.entries(obj)) {\n\t\tprint(`${prop}: ${JSON.stringify(value)}`, offset + 0.5);\n\t}\n};\n\nconst tap = print => {\n\tconst yaml = toYaml(print);\n\treturn {\n\t\tversion(version = 13) {\n\t\t\tprint(`TAP version ${version}`);\n\t\t},\n\t\ttitle(value, offset = 0) {\n\t\t\tconst message = offset > 0 ? `Subtest: ${value}` : value;\n\t\t\tthis.comment(message, offset);\n\t\t},\n\t\tassert(value, offset = 0) {\n\t\t\tconst {pass, description, id, executionTime, expected = '', actual = '', at = '', operator = ''} = value;\n\t\t\tconst label = pass === true ? 'ok' : 'not ok';\n\t\t\tprint(`${label} ${id} - ${description}${executionTime ? ` # time=${executionTime}ms` : ''}`, offset);\n\t\t\tif (pass === false && value.operator) {\n\t\t\t\tprint('---', offset + 0.5);\n\t\t\t\tyaml({expected, actual, at, operator}, offset);\n\t\t\t\tprint('...', offset + 0.5);\n\t\t\t}\n\t\t},\n\t\tplan(value, offset = 0) {\n\t\t\tprint(`1..${value.end}`, offset);\n\t\t},\n\t\ttime(value, offset = 0) {\n\t\t\tthis.comment(`time=${value}ms`, offset);\n\t\t},\n\t\tcomment(value, offset = 0) {\n\t\t\tprint(`# ${value}`, offset);\n\t\t},\n\t\tbailout(value = 'Unhandled exception') {\n\t\t\tprint(`Bail out! ${value}`);\n\t\t},\n\t\ttestAssert(value, offset = 0) {\n\t\t\treturn this.assert(value, offset);\n\t\t}\n\t};\n};\n\nexport default (printFn = print) => {\n\tconst reporter = tap(printFn);\n\treturn (toPrint = {}) => {\n\t\tconst {data, type, offset = 0} = toPrint;\n\t\tif (typeof reporter[type] === 'function') {\n\t\t\treporter[type](data, offset);\n\t\t}\n\t\t// Else ignore (unknown message type)\n\t};\n};\n","// Some combinators for asynchronous iterators: this will be way more easier when\n// Async generator are widely supported\n\nconst asyncIterator = behavior => Object.assign({\n\t[Symbol.asyncIterator]() {\n\t\treturn this;\n\t}\n}, behavior);\n\nexport const filter = predicate => iterator => asyncIterator({\n\tasync next() {\n\t\tconst {done, value} = await iterator.next();\n\n\t\tif (done === true) {\n\t\t\treturn {done};\n\t\t}\n\n\t\tif (!predicate(value)) {\n\t\t\treturn this.next();\n\t\t}\n\n\t\treturn {done, value};\n\t}\n});\n\nexport const map = mapFn => iterator => asyncIterator({\n\t[Symbol.asyncIterator]() {\n\t\treturn this;\n\t},\n\tasync next() {\n\t\tconst {done, value} = await iterator.next();\n\t\tif (done === true) {\n\t\t\treturn {done};\n\t\t}\n\t\treturn {done, value: mapFn(value)};\n\t}\n});\n\nexport const stream = asyncIterator => Object.assign(asyncIterator, {\n\tmap(fn) {\n\t\treturn stream(map(fn)(asyncIterator));\n\t},\n\tfilter(fn) {\n\t\treturn stream(filter(fn)(asyncIterator));\n\t}\n});\n\nexport const combine = (...iterators) => {\n\tconst [...pending] = iterators;\n\tlet current = pending.shift();\n\n\treturn asyncIterator({\n\t\tasync next() {\n\t\t\tif (current === undefined) {\n\t\t\t\treturn {done: true};\n\t\t\t}\n\n\t\t\tconst {done, value} = await current.next();\n\n\t\t\tif (done === true) {\n\t\t\t\tcurrent = pending.shift();\n\t\t\t\treturn this.next();\n\t\t\t}\n\n\t\t\treturn {done, value};\n\t\t}\n\t});\n};\n","import tester from './lib/test';\nimport tap from './lib/tap';\nimport {combine, stream} from './lib/combinators';\n\nlet flatten = true;\nconst tests = [];\nconst test = tester(t => tests.push(t));\n\n// Provide a root context for BSD style test suite\nconst subTest = (test('Root', () => {})).test;\ntest.test = (description, spec) => {\n\tflatten = false; // Turn reporter into BSD style\n\treturn subTest(description, spec);\n};\n\nconst start = async ({reporter = tap()} = {}) => {\n\tlet count = 0;\n\tlet failure = 0;\n\treporter({type: 'version', data: 13});\n\n\t// Remove the irrelevant root title\n\tawait tests[0].next();\n\n\tlet outputStream = stream(combine(...tests));\n\toutputStream = flatten ? outputStream\n\t\t.filter(({type}) => type !== 'testAssert')\n\t\t.map(item => Object.assign(item, {offset: 0})) :\n\t\toutputStream;\n\n\tconst filterOutAtRootLevel = ['plan', 'time'];\n\toutputStream = outputStream\n\t\t.filter(item => item.offset > 0 || !filterOutAtRootLevel.includes(item.type))\n\t\t.map(item => {\n\t\t\tif (item.offset > 0 || (item.type !== 'assert' && item.type !== 'testAssert')) {\n\t\t\t\treturn item;\n\t\t\t}\n\n\t\t\tcount++;\n\t\t\titem.data.id = count;\n\t\t\tfailure += item.data.pass ? 0 : 1;\n\t\t\treturn item;\n\t\t});\n\n\t// One day with for await loops ... :) !\n\twhile (true) {\n\t\tconst {done, value} = await outputStream.next();\n\n\t\tif (done === true) {\n\t\t\tbreak;\n\t\t}\n\n\t\treporter(value);\n\n\t\tif (value.type === 'bailout') {\n\t\t\tthrow value.data; // Rethrow but with Nodejs we keep getting the deprecation warning (unhandled promise) and the process exists with 0 exit code...\n\t\t}\n\t}\n\n\treporter({type: 'plan', data: {start: 1, end: count}});\n\treporter({type: 'comment', data: failure > 0 ? `failed ${failure} of ${count} tests` : 'ok'});\n};\n\n// Auto bootstrap following async env vs sync env (browser vs node)\nif (typeof window === 'undefined') {\n\tsetTimeout(start, 0);\n} else {\n\twindow.addEventListener('load', start);\n}\n\nexport default test;\n","import {\n\tsetAttributes,\n\tremoveAttributes,\n\taddEventListeners,\n\tremoveEventListeners,\n\tsetTextNode,\n\tgetEventListeners\n} from '../lib/dom-util';\nimport {noop} from '../lib/util';\nimport test from 'zora';\n\nconst domProto = {\n\n\tremoveAttribute(attr) {\n\t\tdelete this[attr];\n\t},\n\n\tsetAttribute(attr, val) {\n\t\tthis[attr] = val;\n\t},\n\n\taddEventListener(event, handler) {\n\t\tthis.handlers[event] = handler;\n\t},\n\n\tremoveEventListener(event, handler) {\n\t\tdelete this.handlers[event];\n\t}\n};\n\nconst fakeDom = () => {\n\tconst dom = Object.create(domProto);\n\tObject.defineProperty(dom, 'handlers', {value: {}});\n\treturn dom;\n};\n\nconst ownProps = (obj) => {\n\tconst ownProperties = [];\n\tfor (let prop in obj) {\n\t\tif (obj.hasOwnProperty(prop)) {\n\t\t\townProperties.push(prop);\n\t\t}\n\t}\n\treturn ownProperties;\n};\n\ntest('set attributes', t => {\n\tconst d = fakeDom();\n\tconst update = setAttributes([['foo', 'bar'], ['blah', 2], ['woot', true]]);\n\tconst n = update(d);\n\tt.equal(n, d, 'should have forwarded dom node');\n\tt.equal(d.foo, 'bar');\n\tt.equal(d.blah, 2);\n\tt.equal(d.woot, true);\n\tconst props = ownProps(d);\n\tt.deepEqual(props, ['foo', 'blah', 'woot']);\n\tconst handlers = ownProps(d.handlers);\n\tt.equal(handlers.length, 0);\n});\ntest('remove attribute if value is false', t => {\n\tconst d = fakeDom();\n\td.foo = 'bar';\n\tt.deepEqual(ownProps(d), ['foo']);\n\tconst update = setAttributes([['foo', false]]);\n\tconst n = update(d);\n\tt.equal(n, d, 'should have forwarded dom node');\n\tt.equal(d.foo, undefined);\n\tt.equal(ownProps(d).length, 0);\n\tconst handlers = ownProps(d.handlers);\n\tt.equal(handlers.length, 0);\n});\ntest('remove attributes', t => {\n\tconst d = fakeDom();\n\td.foo = 'bar';\n\td.woot = 2;\n\td.bar = 'blah';\n\tt.deepEqual(ownProps(d), ['foo', 'woot', 'bar']);\n\tconst update = removeAttributes(['foo', 'woot']);\n\tconst n = update(d);\n\tt.equal(n, d, 'should have forwarded dom node');\n\tt.equal(d.bar, 'blah');\n\tt.equal(ownProps(d).length, 1);\n\tconst handlers = ownProps(d.handlers);\n\tt.equal(handlers.length, 0);\n});\ntest('add event listeners', t => {\n\tconst d = fakeDom();\n\tconst update = addEventListeners([['click', noop\n\t], ['input', noop]]);\n\tconst n = update(d);\n\tt.equal(n, d, 'should have forwarded the node');\n\tt.equal(ownProps(d).length, 0);\n\tt.deepEqual(ownProps(d.handlers), ['click', 'input']);\n\tt.equal(d.handlers.click, noop);\n\tt.equal(d.handlers.input, noop);\n});\ntest('remove event listeners', t => {\n\tconst d = fakeDom();\n\td.handlers.click = noop;\n\td.handlers.input = noop;\n\tconst update = removeEventListeners([['click', noop\n\t]]);\n\tconst n = update(d);\n\tt.equal(n, d, 'should have forwarded the node');\n\tt.deepEqual(ownProps(d.handlers), ['input']);\n\tt.equal(d.handlers.input, noop);\n});\ntest('set text node value', function * (t) {\n\tconst node = {};\n\tconst update = setTextNode('foo');\n\tupdate(node);\n\tt.equal(node.textContent, 'foo');\n});\ntest('get event Listeners from props object', t => {\n\tconst props = {\n\t\tonClick: () => {\n\t\t},\n\t\tinput: () => {\n\t\t},\n\t\tonMousedown: () => {\n\t\t}\n\t};\n\n\tconst events = getEventListeners(props);\n\tt.deepEqual(events, [\n\t\t['click', props.onClick],\n\t\t['mousedown', props.onMousedown],\n\t]);\n});","const createTextVNode = value => ({\n\tnodeType: 'Text',\n\tchildren: [],\n\tprops: {value},\n\tlifeCycle: 0\n});\n\nconst normalize = (children, currentText = '', normalized = []) => {\n\tif (children.length === 0) {\n\t\tif (currentText) {\n\t\t\tnormalized.push(createTextVNode(currentText));\n\t\t}\n\t\treturn normalized;\n\t}\n\n\tconst child = children.shift();\n\tconst type = typeof child;\n\tif (type === 'object' || type === 'function') {\n\t\tif (currentText) {\n\t\t\tnormalized.push(createTextVNode(currentText));\n\t\t\tcurrentText = '';\n\t\t}\n\t\tnormalized.push(child);\n\t} else {\n\t\tcurrentText += child;\n\t}\n\n\treturn normalize(children, currentText, normalized);\n};\n\n/**\n * Transform hyperscript into virtual dom node\n * @param nodeType {Function, String} - the HTML tag if string, a component or combinator otherwise\n * @param props {Object} - the list of properties/attributes associated to the related node\n * @param children - the virtual dom nodes related to the current node children\n * @returns {Object} - a virtual dom node\n */\nexport default function h(nodeType, props, ...children) {\n\tconst flatChildren = [];\n\tfor (const c of children) {\n\t\tif (Array.isArray(c)) {\n\t\t\tflatChildren.push(...c);\n\t\t} else {\n\t\t\tflatChildren.push(c);\n\t\t}\n\t}\n\n\tconst normalizedChildren = normalize(flatChildren);\n\n\tif (typeof nodeType !== 'function') { // Regular html/text node\n\t\treturn {\n\t\t\tnodeType,\n\t\t\tprops,\n\t\t\tchildren: normalizedChildren,\n\t\t\tlifeCycle: 0\n\t\t};\n\t}\n\n\tconst fullProps = Object.assign({children: normalizedChildren}, props);\n\tconst comp = nodeType(fullProps);\n\tconst compType = typeof comp;\n\treturn compType !== 'function' ? comp : h(comp, props, ...normalizedChildren); // Functional comp vs combinator (HOC)\n}\n","export default function * traverse(vnode) {\n\tyield vnode;\n\tif (vnode.children && vnode.children.length > 0) {\n\t\tfor (const child of vnode.children) {\n\t\t\tyield * traverse(child);\n\t\t}\n\t}\n}\n","import {compose, curry} from 'smart-table-operators';\nimport {\n\tisShallowEqual,\n\tpairify,\n\tnextTick,\n\tnoop\n} from './util';\nimport {\n\tremoveAttributes,\n\tsetAttributes,\n\tsetTextNode,\n\tcreateDomNode,\n\tremoveEventListeners,\n\taddEventListeners,\n\tgetEventListeners\n} from './dom-util';\nimport traverse from './traverse';\n\nconst updateEventListeners = ({props: newNodeProps} = {}, {props: oldNodeProps} = {}) => {\n\tconst newNodeEvents = getEventListeners(newNodeProps || {});\n\tconst oldNodeEvents = getEventListeners(oldNodeProps || {});\n\n\treturn newNodeEvents.length || oldNodeEvents.length ?\n\t\tcompose(\n\t\t\tremoveEventListeners(oldNodeEvents),\n\t\t\taddEventListeners(newNodeEvents)\n\t\t) : noop;\n};\n\nconst updateAttributes = (newVNode, oldVNode) => {\n\tconst newVNodeProps = newVNode.props || {};\n\tconst oldVNodeProps = oldVNode.props || {};\n\n\tif (isShallowEqual(newVNodeProps, oldVNodeProps)) {\n\t\treturn noop;\n\t}\n\n\tif (newVNode.nodeType === 'Text') {\n\t\treturn setTextNode(newVNode.props.value);\n\t}\n\n\tconst newNodeKeys = Object.keys(newVNodeProps);\n\tconst oldNodeKeys = Object.keys(oldVNodeProps);\n\tconst attributesToRemove = oldNodeKeys.filter(k => !newNodeKeys.includes(k));\n\n\treturn compose(\n\t\tremoveAttributes(attributesToRemove),\n\t\tsetAttributes(newNodeKeys.map(pairify(newVNodeProps)))\n\t);\n};\n\nconst domFactory = createDomNode;\n\n// Apply vnode diffing to actual dom node (if new node => it will be mounted into the parent)\nconst domify = (oldVnode, newVnode, parentDomNode) => {\n\tif (!oldVnode && newVnode) { // There is no previous vnode\n\t\tnewVnode.dom = parentDomNode.appendChild(domFactory(newVnode, parentDomNode));\n\t\tnewVnode.lifeCycle = 1;\n\t\treturn {vnode: newVnode, garbage: null};\n\t}\n\n\t// There is a previous vnode\n\tif (!newVnode) { // We must remove the related dom node\n\t\tparentDomNode.removeChild(oldVnode.dom);\n\t\treturn ({garbage: oldVnode, dom: null});\n\t} else if (newVnode.nodeType !== oldVnode.nodeType) { // It must be replaced\n\t\tnewVnode.dom = domFactory(newVnode, parentDomNode);\n\t\tnewVnode.lifeCycle = 1;\n\t\tparentDomNode.replaceChild(newVnode.dom, oldVnode.dom);\n\t\treturn {garbage: oldVnode, vnode: newVnode};\n\t}\n\n\t// Only update attributes\n\tnewVnode.dom = oldVnode.dom;\n\t// Pass the unMountHook\n\tif (oldVnode.onUnMount) {\n\t\tnewVnode.onUnMount = oldVnode.onUnMount;\n\t}\n\tnewVnode.lifeCycle = oldVnode.lifeCycle + 1;\n\treturn {garbage: null, vnode: newVnode};\n};\n\n/**\n * Render a virtual dom node, diffing it with its previous version, mounting it in a parent dom node\n * @param oldVnode\n * @param newVnode\n * @param parentDomNode\n * @param onNextTick collect operations to be processed on next tick\n * @returns {Array}\n */\nexport const render = (oldVnode, newVnode, parentDomNode, onNextTick = []) => {\n\t// 1. transform the new vnode to a vnode connected to an actual dom element based on vnode versions diffing\n\t// \ti. note at this step occur dom insertions/removals\n\t// \tii. it may collect sub tree to be dropped (or \"unmounted\")\n\tconst {vnode, garbage} = domify(oldVnode, newVnode, parentDomNode);\n\n\tif (garbage !== null) {\n\t\t// Defer unmount lifecycle as it is not \"visual\"\n\t\tfor (const g of traverse(garbage)) {\n\t\t\tif (g.onUnMount) {\n\t\t\t\tonNextTick.push(g.onUnMount);\n\t\t\t}\n\t\t}\n\t}\n\n\t// Normalisation of old node (in case of a replace we will consider old node as empty node (no children, no props))\n\tconst tempOldNode = garbage !== null || !oldVnode ? {length: 0, children: [], props: {}} : oldVnode;\n\n\tif (vnode) {\n\t\t// 2. update dom attributes based on vnode prop diffing.\n\t\t// Sync\n\t\tif (vnode.onUpdate && vnode.lifeCycle > 1) {\n\t\t\tvnode.onUpdate();\n\t\t}\n\n\t\tupdateAttributes(vnode, tempOldNode)(vnode.dom);\n\n\t\t// Fast path\n\t\tif (vnode.nodeType === 'Text') {\n\t\t\treturn onNextTick;\n\t\t}\n\n\t\tif (vnode.onMount && vnode.lifeCycle === 1) {\n\t\t\tonNextTick.push(() => vnode.onMount());\n\t\t}\n\n\t\tconst childrenCount = Math.max(tempOldNode.children.length, vnode.children.length);\n\n\t\t// Async will be deferred as it is not \"visual\"\n\t\tconst setListeners = updateEventListeners(vnode, tempOldNode);\n\t\tif (setListeners !== noop) {\n\t\t\tonNextTick.push(() => setListeners(vnode.dom));\n\t\t}\n\n\t\t// 3. recursively traverse children to update dom and collect functions to process on next tick\n\t\tif (childrenCount > 0) {\n\t\t\tfor (let i = 0; i < childrenCount; i++) {\n\t\t\t\t// We pass onNextTick as reference (improve perf: memory + speed)\n\t\t\t\trender(tempOldNode.children[i], vnode.children[i], vnode.dom, onNextTick);\n\t\t\t}\n\t\t}\n\t}\n\n\treturn onNextTick;\n};\n\nexport const hydrate = (vnode, dom) => {\n\tconst hydrated = Object.assign({}, vnode);\n\tconst domChildren = Array.from(dom.childNodes).filter(n => n.nodeType !== 3 || n.nodeValue.trim() !== '');\n\thydrated.dom = dom;\n\thydrated.children = vnode.children.map((child, i) => hydrate(child, domChildren[i]));\n\treturn hydrated;\n};\n\nexport const mount = curry((comp, initProp, root) => {\n\tconst vnode = comp.nodeType !== void 0 ? comp : comp(initProp || {});\n\tconst oldVNode = root.children.length ? hydrate(vnode, root.children[0]) : null;\n\tconst batch = render(oldVNode, vnode, root);\n\tnextTick(() => {\n\t\tfor (const op of batch) {\n\t\t\top();\n\t\t}\n\t});\n\treturn vnode;\n});\n","import {render} from './dom-renderer';\nimport {nextTick} from './util';\n\n/**\n * Create a function which will trigger an update of the component with the passed state\n * @param comp {Function} - the component to update\n * @param initialVNode - the initial virtual dom node related to the component (ie once it has been mounted)\n * @returns {Function} - the update function\n */\nexport default (comp, initialVNode) => {\n\tlet oldNode = initialVNode;\n\treturn (props, ...args) => {\n\t\tconst mount = oldNode.dom.parentNode;\n\t\tconst newNode = comp(Object.assign({children: oldNode.children || []}, oldNode.props, props), ...args);\n\t\tconst nextBatch = render(oldNode, newNode, mount);\n\n\t\t// Danger zone !!!!\n\t\t// Change by keeping the same reference so the eventual parent node does not need to be \"aware\" tree may have changed downstream: oldNode may be the child of someone ...(well that is a tree data structure after all :P )\n\t\toldNode = Object.assign(oldNode || {}, newNode);\n\t\t// End danger zone\n\n\t\tnextTick(() => {\n\t\t\tfor (const op of nextBatch) {\n\t\t\t\top();\n\t\t\t}\n\t\t});\n\n\t\treturn newNode;\n\t};\n};\n","import {curry, compose} from 'smart-table-operators';\n\nconst lifeCycleFactory = method => curry((fn, comp) => (props, ...args) => {\n\tconst n = comp(props, ...args);\n\tconst applyFn = () => fn(n, ...args);\n\tconst current = n[method];\n\tn[method] = current ? compose(current, applyFn) : applyFn;\n\treturn n;\n});\n\n/**\n * Life cycle: when the component is mounted\n */\nexport const onMount = lifeCycleFactory('onMount');\n\n/**\n * Life cycle: when the component is unmounted\n */\nexport const onUnMount = lifeCycleFactory('onUnMount');\n\n/**\n * Life cycle: before the component is updated\n */\nexport const onUpdate = lifeCycleFactory('onUpdate');\n","import {compose} from 'smart-table-operators';\nimport update from './update';\nimport {onMount, onUpdate} from './lifecycles';\n\n/**\n * Combinator to create a \"stateful component\": ie it will have its own state and the ability to update its own tree\n * @param comp {Function} - the component\n * @returns {Function} - a new wrapped component\n */\nexport default comp => () => {\n\tlet updateFunc;\n\t// Lazy evaluate updateFunc (to make sure it is defined\n\tconst wrapperComp = (props, ...args) => comp(props, newState => updateFunc(newState), ...args);\n\n\tconst setUpdateFunction = vnode => {\n\t\tupdateFunc = update(wrapperComp, vnode);\n\t};\n\n\treturn compose(onMount(setUpdateFunction), onUpdate(setUpdateFunction))(wrapperComp);\n};\n","import h from './h';\n\n// Main root\n// todo\n// Document metadata\n// todo\n// Sectioning root\nexport const body = (...args) => h('body', ...args);\n// Content sectioning\nexport const address = (...args) => h('address', ...args);\nexport const article = (...args) => h('article', ...args);\nexport const aside = (...args) => h('aside', ...args);\nexport const footer = (...args) => h('footer', ...args);\nexport const header = (...args) => h('header', ...args);\nexport const h1 = (...args) => h('h1', ...args);\nexport const h2 = (...args) => h('h2', ...args);\nexport const h3 = (...args) => h('h3', ...args);\nexport const h4 = (...args) => h('h4', ...args);\nexport const h5 = (...args) => h('h5', ...args);\nexport const h6 = (...args) => h('h6', ...args);\nexport const hgroup = (...args) => h('hgroup', ...args);\nexport const nav = (...args) => h('nav', ...args);\nexport const section = (...args) => h('section', ...args);\n// Text content\nexport const blockquote = (...args) => h('blockquote', ...args);\nexport const dd = (...args) => h('dd', ...args);\nexport const dir = (...args) => h('dir', ...args);\nexport const div = (...args) => h('div', ...args);\nexport const dl = (...args) => h('dl', ...args);\nexport const dt = (...args) => h('dt', ...args);\nexport const figcaption = (...args) => h('figcaption', ...args);\nexport const figure = (...args) => h('figure', ...args);\nexport const hr = (...args) => h('hr', ...args);\nexport const li = (...args) => h('li', ...args);\nexport const main = (...args) => h('main', ...args);\nexport const ol = (...args) => h('ol', ...args);\nexport const p = (...args) => h('p', ...args);\nexport const pre = (...args) => h('pre', ...args);\nexport const ul = (...args) => h('ul', ...args);\n// Inline text semantic\nexport const a = (...args) => h('a', ...args);\nexport const abbr = (...args) => h('abbr', ...args);\nexport const b = (...args) => h('b', ...args);\nexport const bdi = (...args) => h('bdi', ...args);\nexport const bdo = (...args) => h('bdo', ...args);\nexport const br = (...args) => h('br', ...args);\nexport const cite = (...args) => h('cite', ...args);\nexport const quote = (...args) => h('quote', ...args);\nexport const data = (...args) => h('data', ...args);\nexport const dfn = (...args) => h('dfn', ...args);\nexport const em = (...args) => h('em', ...args);\nexport const i = (...args) => h('i', ...args);\nexport const kbd = (...args) => h('kbd', ...args);\nexport const mark = (...args) => h('mark', ...args);\nexport const q = (...args) => h('q', ...args);\nexport const rp = (...args) => h('rp', ...args);\nexport const rt = (...args) => h('rt', ...args);\nexport const rtc = (...args) => h('rtc', ...args);\nexport const ruby = (...args) => h('ruby', ...args);\nexport const s = (...args) => h('s', ...args);\nexport const samp = (...args) => h('samp', ...args);\nexport const small = (...args) => h('small', ...args);\nexport const span = (...args) => h('span', ...args);\nexport const strong = (...args) => h('strong', ...args);\nexport const sub = (...args) => h('sub', ...args);\nexport const sup = (...args) => h('sup', ...args);\nexport const time = (...args) => h('time', ...args);\nexport const u = (...args) => h('u', ...args);\n// export const var = (...args) => h('var', ...args);\nexport const wbr = (...args) => h('wbr', ...args);\n// Image and multimedia\nexport const area = (...args) => h('area', ...args);\nexport const audio = (...args) => h('audio', ...args);\nexport const img = (...args) => h('img', ...args);\nexport const map = (...args) => h('map', ...args);\nexport const track = (...args) => h('track', ...args);\nexport const video = (...args) => h('video', ...args);\n// Embedded content\nexport const embed = (...args) => h('embed', ...args);\nexport const object = (...args) => h('object', ...args);\nexport const param = (...args) => h('param', ...args);\nexport const picture = (...args) => h('picture', ...args);\nexport const source = (...args) => h('source', ...args);\n// Scripting\n// todo\n// Demarcating edit\n// todo\n// Table content\nexport const caption = (...args) => h('caption', ...args);\nexport const col = (...args) => h('col', ...args);\nexport const colgroup = (...args) => h('colgroup', ...args);\nexport const table = (...args) => h('table', ...args);\nexport const tbody = (...args) => h('tbody', ...args);\nexport const td = (...args) => h('td', ...args);\nexport const tfoot = (...args) => h('tfoot', ...args);\nexport const th = (...args) => h('th', ...args);\nexport const thead = (...args) => h('thead', ...args);\nexport const tr = (...args) => h('tr', ...args);\n// Forms\nexport const button = (...args) => h('button', ...args);\nexport const datalist = (...args) => h('datalist', ...args);\nexport const fieldset = (...args) => h('fieldset', ...args);\nexport const form = (...args) => h('form', ...args);\nexport const input = (...args) => h('input', ...args);\nexport const label = (...args) => h('label', ...args);\nexport const legend = (...args) => h('legend', ...args);\nexport const meter = (...args) => h('meter', ...args);\nexport const optgroup = (...args) => h('optgroup', ...args);\nexport const option = (...args) => h('option', ...args);\nexport const output = (...args) => h('output', ...args);\nexport const progress = (...args) => h('progress', ...args);\nexport const select = (...args) => h('select', ...args);\nexport const textarea = (...args) => h('textarea', ...args);\n// Interactive elements\n// todo\n\n\n","import {curry} from 'smart-table-operators';\n\nconst filterOutFunction = props => Object\n\t.entries(props || {})\n\t.filter(([key, value]) => typeof value !== 'function');\n\nconst escapeHTML = s => String(s)\n\t.replace(/&/g, '&amp;')\n\t.replace(/</g, '&lt;')\n\t.replace(/>/g, '&gt;');\n\nconst render = curry((comp, initProp) => {\n\tconst vnode = comp.nodeType !== void 0 ? comp : comp(initProp || {});\n\tconst {nodeType, children, props} = vnode;\n\tconst attributes = escapeHTML(filterOutFunction(props)\n\t\t.map(([key, value]) => typeof value === 'boolean' ? (value === true ? key : '') : `${key}=\"${value}\"`)\n\t\t.join(' '));\n\tconst childrenHtml = children !== void 0 && children.length > 0 ? children.map(ch => render(ch)()).join('') : '';\n\treturn nodeType === 'Text' ? escapeHTML(String(props.value)) : `<${nodeType}${attributes ? ` ${attributes}` : ''}>${childrenHtml}</${nodeType}>`;\n});\n\nexport default render;\n","import test from 'zora';\nimport {h} from '../index';\n\ntest('create regular html node', t => {\n\tconst vnode = h('div', {id: 'someId', 'class': 'special'});\n\tt.deepEqual(vnode, {lifeCycle: 0, nodeType: 'div', props: {id: 'someId', 'class': 'special'}, children: []});\n});\ntest('normalize text node', t => {\n\tconst vnode = h('div', {id: 'someId', 'class': 'special'}, 'foo', 'bar');\n\tt.deepEqual(vnode, {\n\t\tnodeType: 'div',\n\t\tprops: {id: 'someId', class: 'special'},\n\t\tchildren: [{nodeType: 'Text', children: [], props: {'value': 'foobar'}, lifeCycle: 0}],\n\t\tlifeCycle: 0\n\t});\n});\ntest('create regular html node with text node children', t => {\n\tconst vnode = h('div', {id: 'someId', 'class': 'special'}, 'foo');\n\tt.deepEqual(vnode, {\n\t\tnodeType: 'div', lifeCycle: 0, props: {id: 'someId', 'class': 'special'}, children: [{\n\t\t\tnodeType: 'Text',\n\t\t\tchildren: [],\n\t\t\tprops: {value: 'foo'},\n\t\t\tlifeCycle: 0\n\t\t}]\n\t});\n});\ntest('create regular html with children', t => {\n\tconst vnode = h('ul', {id: 'collection'}, h('li', {id: 1}, 'item1'), h('li', {id: 2}, 'item2'));\n\tt.deepEqual(vnode, {\n\t\tnodeType: 'ul',\n\t\tprops: {id: 'collection'},\n\t\tlifeCycle: 0,\n\t\tchildren: [\n\t\t\t{\n\t\t\t\tnodeType: 'li',\n\t\t\t\tprops: {id: 1},\n\t\t\t\tlifeCycle: 0,\n\t\t\t\tchildren: [{\n\t\t\t\t\tnodeType: 'Text',\n\t\t\t\t\tprops: {value: 'item1'},\n\t\t\t\t\tchildren: [],\n\t\t\t\t\tlifeCycle: 0\n\t\t\t\t}]\n\t\t\t}, {\n\t\t\t\tnodeType: 'li',\n\t\t\t\tprops: {id: 2},\n\t\t\t\tlifeCycle: 0,\n\t\t\t\tchildren: [{\n\t\t\t\t\tnodeType: 'Text',\n\t\t\t\t\tprops: {value: 'item2'},\n\t\t\t\t\tchildren: [],\n\t\t\t\t\tlifeCycle: 0\n\t\t\t\t}]\n\t\t\t}\n\t\t]\n\t});\n});\ntest('use function as component passing the children as prop', t => {\n\tconst foo = (props) => h('p', props);\n\tconst vnode = h(foo, {id: 1}, 'hello world');\n\tt.deepEqual(vnode, {\n\t\tnodeType: 'p',\n\t\tlifeCycle: 0,\n\t\tprops: {\n\t\t\tchildren: [{\n\t\t\t\tnodeType: 'Text',\n\t\t\t\tlifeCycle: 0,\n\t\t\t\tchildren: [],\n\t\t\t\tprops: {value: 'hello world'}\n\t\t\t}],\n\t\t\tid: 1\n\t\t},\n\t\tchildren: []\n\t});\n});\ntest('use nested combinator to create vnode', t => {\n\tconst combinator = () => () => () => () => (props) => h('p', {id: 'foo'});\n\tconst vnode = h(combinator, {});\n\tt.deepEqual(vnode, {nodeType: 'p', lifeCycle: 0, props: {id: 'foo'}, children: []});\n});\n","export const waitNextTick = () => new Promise(function (resolve) {\n\tsetTimeout(function () {\n\t\tresolve();\n\t}, 2)\n});\n","import test from 'zora';\nimport {onMount, onUnMount, h, mount, render} from '../index';\nimport {waitNextTick} from './test-util'\n\ntest('should run a function when component is mounted', async t => {\n\tlet counter = 0;\n\tconst container = document.createElement('div');\n\tconst comp = () => <p>hello world</p>;\n\tconst withMount = onMount(() => {\n\t\tcounter++\n\t}, comp);\n\tmount(withMount, {}, container);\n\tt.equal(counter, 0);\n\tawait waitNextTick();\n\tt.equal(counter, 1);\n});\ntest('should compose the mount function when there are many', async t => {\n\tlet counter = 0;\n\tconst container = document.createElement('div');\n\tconst comp = () => <p>hello world</p>;\n\tconst withMount = onMount(() => {\n\t\tcounter++\n\t}, comp);\n\tconst Combined = onMount(() => {\n\t\tcounter = counter * 10\n\t}, withMount);\n\tmount(Combined, {}, container);\n\tt.equal(counter, 0);\n\tawait waitNextTick();\n\tt.equal(counter, 10);\n});\ntest('should run a function when component is unMounted', t => {\n\tlet unmounted = null;\n\tconst container = document.createElement('div');\n\tconst Item = onUnMount((n) => {\n\t\tunmounted = n;\n\t}, ({id}) => <li id={id}>hello world</li>);\n\tconst containerComp = (({items}) => (<ul>\n\t\t{\n\t\t\titems.map(item => <Item {...item}/>)\n\t\t}\n\t</ul>));\n\n\tconst vnode = mount(containerComp, {items: [{id: 1}, {id: 2}, {id: 3}]}, container);\n\tt.equal(container.innerHTML, '<ul><li id=\"1\">hello world</li><li id=\"2\">hello world</li><li id=\"3\">hello world</li></ul>');\n\tconst batch = render(vnode, containerComp({items: [{id: 1}, {id: 3}]}), container);\n\tt.equal(container.innerHTML, '<ul><li id=\"1\">hello world</li><li id=\"3\">hello world</li></ul>');\n\tfor (let f of batch) {\n\t\tf();\n\t}\n\tt.notEqual(unmounted, null);\n});\n","import test from 'zora';\nimport {mount, h} from '../index';\n\ntest('mount a simple component', t => {\n\tconst container = document.createElement('div');\n\tconst Comp = (props) => (<h1><span id={props.id}>{props.greeting}</span></h1>);\n\tmount(Comp, {id: 123, greeting: 'hello world'}, container);\n\tt.equal(container.innerHTML, '<h1><span id=\"123\">hello world</span></h1>');\n});\ntest('mount composed component', t => {\n\tconst container = document.createElement('div');\n\tconst Comp = (props) => (<h1><span id={props.id}>{props.greeting}</span></h1>);\n\tconst Container = (props) => (<section>\n\t\t<Comp id=\"567\" greeting=\"hello you\"/>\n\t</section>);\n\tmount(Container, {}, container);\n\tt.equal(container.innerHTML, '<section><h1><span id=\"567\">hello you</span></h1></section>');\n});\ntest('mount a component with inner child', t => {\n\tconst container = document.createElement('div');\n\tconst Comp = (props) => (<h1><span id={props.id}>{props.greeting}</span></h1>);\n\tconst Container = (props) => (<section>{props.children}</section>);\n\tmount(() => <Container><Comp id=\"567\" greeting=\"hello world\"/></Container>, {}, container);\n\tt.equal(container.innerHTML, '<section><h1><span id=\"567\">hello world</span></h1></section>');\n});\n","import test from 'zora';\nimport {update, mount, h} from '../index';\n\n\ttest('give ability to update a node (and its descendant)', t => {\n\t\tconst container = document.createElement('div');\n\t\tconst comp = (({id, content}) => (<p id={id}>{content}</p>));\n\t\tconst initialVnode = mount(comp, {id: 123, content: 'hello world'}, container);\n\t\tt.equal(container.innerHTML, '<p id=\"123\">hello world</p>');\n\t\tconst updateFunc = update(comp, initialVnode);\n\t\tupdateFunc({id: 567, content: 'bonjour monde'});\n\t\tt.equal(container.innerHTML, '<p id=\"567\">bonjour monde</p>');\n\t});\n","import test from 'zora';\nimport {isShallowEqual, pairify} from '../lib/util';\nimport traverse from '../lib/traverse';\n\ntest('should traverse a tree (going deep first)', t => {\n\tconst tree = {\n\t\tid: 1,\n\t\tchildren: [\n\t\t\t{id: 2, children: [{id: 3}, {id: 4}]},\n\t\t\t{id: 5, children: [{id: 6}]},\n\t\t\t{id: 7}\n\t\t]\n\t};\n\n\tconst sequence = [...traverse(tree)].map(n => n.id);\n\tt.deepEqual(sequence, [1, 2, 3, 4, 5, 6, 7]);\n})\ntest('pair key to value object of an object (aka Object.entries)', t => {\n\tconst holder = {a: 1, b: 2, c: 3, d: 4};\n\tconst f = pairify(holder);\n\tconst data = Object.keys(holder).map(f);\n\tt.deepEqual(data, [['a', 1], ['b', 2], ['c', 3], ['d', 4]]);\n})\ntest('shallow equality test on object', t => {\n\tconst nested = {foo: 'bar'};\n\tconst obj1 = {a: 1, b: '2', c: true, d: nested};\n\tt.ok(isShallowEqual(obj1, {a: 1, b: '2', c: true, d: nested}));\n\tt.notOk(isShallowEqual(obj1, {\n\t\ta: 1,\n\t\tb: '2',\n\t\tc: true,\n\t\td: {foo: 'bar'}\n\t}), 'nested object should be checked by reference');\n\tt.notOk(isShallowEqual(obj1, {a: 1, b: 2, c: true, d: nested}), 'exact type checking on primitive');\n\tt.notOk(isShallowEqual(obj1, {a: 1, c: true, d: nested}), 'return false on missing properties');\n\tt.notOk(isShallowEqual({a: 1, c: true, d: nested}, obj1), 'return false on missing properties (commmutative');\n});\n","import test from 'zora';\nimport {h, withState, mount} from '../index';\nimport {waitNextTick} from './test-util';\n\ntest('bind an update function to a component', async t => {\n\tlet update = null;\n\tconst Comp = withState(({foo}, setState) => {\n\t\tif (!update) {\n\t\t\tupdate = setState;\n\t\t}\n\t\treturn <p>{foo}</p>;\n\t});\n\tconst container = document.createElement('div');\n\tmount(({foo}) => <Comp foo={foo}/>, {foo: 'bar'}, container);\n\tt.equal(container.innerHTML, '<p>bar</p>');\n\tawait waitNextTick();\n\tupdate({foo: 'bis'});\n\tt.equal(container.innerHTML, '<p>bis</p>');\n});\ntest('should create isolated state for each component', async t => {\n\tlet update1 = null;\n\tlet update2 = null;\n\tconst Comp = withState(({foo}, setState) => {\n\t\tif (!update1) {\n\t\t\tupdate1 = setState;\n\t\t} else if (!update2) {\n\t\t\tupdate2 = setState;\n\t\t}\n\n\t\treturn <p>{foo}</p>;\n\t});\n\tconst container = document.createElement('div');\n\tmount(({foo1, foo2}) => <div><Comp foo={foo1}/><Comp foo={foo2}/></div>, {foo1: 'bar', foo2: 'bar2'}, container);\n\tt.equal(container.innerHTML, '<div><p>bar</p><p>bar2</p></div>');\n\tawait waitNextTick();\n\tupdate1({foo: 'bis'});\n\tt.equal(container.innerHTML, '<div><p>bis</p><p>bar2</p></div>');\n\tupdate2({foo: 'blah'});\n\tt.equal(container.innerHTML, '<div><p>bis</p><p>blah</p></div>');\n});","import test from 'zora';\nimport {h} from '../index';\nimport renderAsString from '../lib/string-renderer';\n\ntest('render a simple component', t => {\n\tconst Comp = props => <h1><span id={props.id}>{props.greeting}</span></h1>;\n\tconst output = renderAsString(Comp, {id: 123, greeting: 'hello world'});\n\tt.equal(output, '<h1><span id=\"123\">hello world</span></h1>');\n});\n\ntest('render nested components', t => {\n\tconst Comp = props => <h1><span id={props.id}>{props.greeting}</span></h1>;\n\tconst Main = props => <main>\n\t\t<Comp id={123} greeting=\"Hello world\"/>\n\t\t<div><p>Some other content</p></div>\n\t</main>;\n\tconst output = renderAsString(Main, {});\n\tt.equal(output, `<main><h1><span id=\"123\">Hello world</span></h1><div><p>Some other content</p></div></main>`);\n});\n\ntest('should drop event listeners', t => {\n\tconst Comp = props => <button onClick={() => {console.log('foo')}}><span\n\t\tid={props.id}>{props.greeting}</span></button>;\n\tconst output = renderAsString(Comp, {id: 123, greeting: 'hello world'});\n\tt.equal(output, '<button><span id=\"123\">hello world</span></button>');\n});\n\ntest('should handle boolean attributes accordingly to html specification', t => {\n\tconst Comp = props => <details open={props.open}>\n\t\t<summary>Some details</summary>\n\t\t<p>Some details content</p></details>;\n\tconst openOutput = renderAsString(Comp, {open: true});\n\tt.equal(openOutput, '<details open><summary>Some details</summary><p>Some details content</p></details>');\n\tconst closeOutput = renderAsString(Comp, {open: false});\n\tt.equal(closeOutput, '<details><summary>Some details</summary><p>Some details content</p></details>');\n});\n\ntest('should prevent html injection', t => {\n\tconst Comp = props => <button id={props.id}>Hello world</button>;\n\tconst props = {\n\t\tid: '\"><script>console.log(\"owned\")</script>'\n\t};\n\tconst output = renderAsString(Comp, props);\n\tt.equal(output, `<button id=\"\\\"&gt;&lt;script&gt;console.log(\\\"owned\\\")&lt;/script&gt;\">Hello world</button>`)\n});"],"names":["compose","first","fns","args","reduce","previous","current","curry","fn","arityLeft","arity","length","argLength","func","moreArgs","tap","arg","SVG_NP","updateDomNodeFactory","method","items","domNode","pair","removeEventListeners","addEventListeners","setAttributes","attributes","filter","key","value","removeAttribute","setAttribute","removeAttributes","attr","setTextNode","val","node","textContent","createDomNode","vnode","parent","nodeType","document","createElementNS","createTextNode","namespaceURI","createElement","getEventListeners","props","Object","keys","k","substr","map","toLowerCase","nextTick","setTimeout","pairify","holder","isShallowEqual","a","b","aKeys","bKeys","every","noop","exports","module","shim","obj","push","supportsArgumentsClass","prototype","toString","call","arguments","supported","unsupported","object","hasOwnProperty","propertyIsEnumerable","pSlice","Array","slice","deepEqual","actual","expected","opts","Date","getTime","strict","objEquiv","isUndefinedOrNull","undefined","isBuffer","x","copy","i","isArguments","ka","objectKeys","kb","e","sort","getAssertionLocation","err","Error","stack","split","trim","replace","assertMethodHook","assertResult","pass","at","collect","Assertion","ok","description","Boolean","operator","equal","notOk","notDeepEqual","notEqual","throws","caught","error","RegExp","test","message","String","constructor","doesNotThrow","fail","assign","create","spec","task","tester","offset","buffer","type","data","result","count","done","createAssertion","item","collector","id","Symbol","asyncIterator","handleDelegate","delegate","next","executionTime","subTestAssertion","shift","unshift","instance","subTest","start","now","assertFn","assert","Promise","resolve","then","end","catch","print","console","log","padStart","toYaml","prop","entries","JSON","stringify","yaml","version","title","comment","label","plan","time","bailout","testAssert","printFn","reporter","toPrint","behavior","predicate","iterator","mapFn","stream","combine","iterators","pending","flatten","tests","t","failure","outputStream","filterOutAtRootLevel","includes","window","addEventListener","domProto","event","handler","handlers","removeEventListener","fakeDom","dom","defineProperty","ownProps","ownProperties","d","update","n","foo","blah","woot","bar","click","input","onClick","onMousedown","events","createTextVNode","children","lifeCycle","normalize","currentText","normalized","child","h","flatChildren","c","isArray","normalizedChildren","fullProps","comp","compType","traverse","updateEventListeners","newNodeProps","oldNodeProps","newNodeEvents","oldNodeEvents","updateAttributes","newVNode","oldVNode","newVNodeProps","oldVNodeProps","newNodeKeys","oldNodeKeys","attributesToRemove","domFactory","domify","oldVnode","newVnode","parentDomNode","appendChild","garbage","removeChild","replaceChild","onUnMount","render","onNextTick","g","tempOldNode","onUpdate","onMount","childrenCount","Math","max","setListeners","hydrate","hydrated","domChildren","from","childNodes","nodeValue","mount","initProp","root","batch","op","initialVNode","oldNode","parentNode","newNode","nextBatch","lifeCycleFactory","applyFn","updateFunc","wrapperComp","newState","setUpdateFunction","filterOutFunction","escapeHTML","s","join","childrenHtml","ch","class","combinator","waitNextTick","counter","container","withMount","Combined","unmounted","Item","containerComp","innerHTML","f","Comp","greeting","Container","content","initialVnode","tree","sequence","nested","obj1","withState","setState","update1","update2","foo1","foo2","output","renderAsString","Main","open","openOutput","closeOutput"],"mappings":"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"}